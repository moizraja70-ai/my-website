import{c as h,a as r,b as w,j as e,L as p,C as v,u as y}from"./index-8cryRX8J.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],k=h("circle-x",_);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],C=h("search",S),E=()=>{const[u,b]=r.useState([]),[g,c]=r.useState(!0),[o,i]=r.useState(null),[l,j]=r.useState(""),[d,m]=r.useState(null);r.useEffect(()=>{n()},[]);const n=async()=>{c(!0),i(null);try{const s=new Promise((L,N)=>setTimeout(()=>N(new Error("Request timed out. Check your network or RLS policies.")),1e4)),{data:a,error:t}=await Promise.race([w(),s]);t?(console.error("Failed to fetch users:",t),i(t.message||JSON.stringify(t))):a&&b(a)}catch(s){console.error("Fetch error:",s),i(s.message||"Unknown error occurred")}finally{c(!1)}},f=async s=>{if(!confirm(`Are you sure you want to ${s.is_subscribed?"REMOVE":"GRANT"} subscription for ${s.email}?`))return;m(s.id);const a=s.is_subscribed?{is_subscribed:!1,subscription_plan:null,subscription_end_date:null}:{is_subscribed:!0,subscription_plan:"manual-admin",subscription_end_date:new Date(Date.now()+4320*60*60*1e3).toISOString()},{error:t}=await y(s.id,a);t?alert("Failed to update: "+t.message):await n(),m(null)},x=u.filter(s=>{var a,t;return((a=s.email)==null?void 0:a.toLowerCase().includes(l.toLowerCase()))||((t=s.full_name)==null?void 0:t.toLowerCase().includes(l.toLowerCase()))});return e.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-200 font-sans p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Admin Dashboard"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage users and subscriptions"})]}),e.jsx("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors",children:"Back to App"})]}),e.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-4 mb-6 flex gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search by email or name...",value:l,onChange:s=>j(s.target.value),className:"w-full bg-slate-950 border border-slate-700 rounded-lg pl-10 pr-4 py-2 text-sm focus:outline-none focus:border-purple-500"})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-purple-600/20 text-purple-300 hover:bg-purple-600/30 rounded-lg text-sm font-medium transition-colors",children:"Refresh List"})]}),!1,e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-2xl",children:[o&&e.jsxs("div",{className:"p-4 bg-red-900/50 border-l-4 border-red-500 text-red-200 mb-4 mx-4 mt-4",children:[e.jsx("strong",{children:"Error Loading Data:"})," ",o,e.jsx("br",{}),e.jsx("span",{className:"text-sm opacity-75",children:"Database RLS Policy may be blocking access."})]}),g?e.jsx("div",{className:"p-12 flex justify-center",children:e.jsx(p,{className:"w-8 h-8 animate-spin text-purple-500"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-800/50 text-slate-400 text-xs uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 font-medium",children:"User"}),e.jsx("th",{className:"p-4 font-medium",children:"Role"}),e.jsx("th",{className:"p-4 font-medium",children:"Status"}),e.jsx("th",{className:"p-4 font-medium",children:"Plan"}),e.jsx("th",{className:"p-4 font-medium text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800",children:[x.map(s=>e.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:s.email}),e.jsx("div",{className:"text-xs text-slate-500",children:s.full_name||"No Name"}),e.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-0.5",children:s.id})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.role==="admin"?"bg-purple-500/20 text-purple-300":"bg-slate-700/50 text-slate-400"}`,children:s.role||"user"})}),e.jsx("td",{className:"p-4",children:s.is_subscribed?e.jsxs("div",{className:"flex items-center gap-1.5 text-green-400 text-sm",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:"Active"})]}):e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500 text-sm",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Free"})]})}),e.jsxs("td",{className:"p-4 text-sm text-slate-400",children:[s.subscription_plan||"-",s.subscription_end_date&&e.jsxs("div",{className:"text-[10px] text-slate-600",children:["Ends: ",new Date(s.subscription_end_date).toLocaleDateString()]})]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>f(s),disabled:d===s.id,className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${s.is_subscribed?"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20":"bg-green-500/10 text-green-400 hover:bg-green-500/20 border border-green-500/20"}`,children:d===s.id?e.jsx(p,{className:"w-4 h-4 animate-spin"}):s.is_subscribed?"Revoke Access":"Grant Access"})})]},s.id)),x.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"p-8 text-center text-slate-500",children:['No users found matching "',l,'"']})})]})]})})]})]})})};export{E as default};
