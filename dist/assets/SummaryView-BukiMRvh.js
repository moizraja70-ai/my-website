import{j as e,R as t,a as r,k as s,l as n,m as l,n as o,o as a,p as i,q as d,D as c,s as h,t as u,u as x,v as g,I as m,i as b}from"./vendor-react-DkY5wy_m.js";import{r as p}from"./vendor-react-dom-D9MoHZUj.js";import{M as f}from"./content-gic-thwEcWs7.js";import{f as v,M as k}from"./index-CdIXEr6P.js";import{q as w,w as j}from"./vendor-CimuxmzX.js";import"./content-impression-DXBt_6OM.js";import"./content-gypsum-BiKxCYUT.js";import"./content-composite-TJ9nDpJr.js";import"./content-adhesion-Cn4bavKK.js";import"./content-wax-BDxVPrGY.js";import"./content-metals-D-Ap74sk.js";import"./content-investment-BmTIz0j7.js";import"./content-casting-qFCp4nAV.js";import"./content-cements-BGuPplC7.js";import"./content-amalgam-BEu4a1oj.js";import"./content-ceramics-BD3nGYw3.js";import"./content-properties-BHcOlrks.js";import"./content-denture-B8gJ77JC.js";import"./content-embryology-Czmh6K7E.js";import"./vendor-markdown-CUtcwKjt.js";const y=({src:t,alt:r,onClose:s})=>e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-in fade-in duration-300",onClick:s,children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 text-white/70 hover:text-white bg-white/10 hover:bg-white/20 rounded-full transition-colors z-[101]",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"relative max-w-full max-h-full",onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:t,alt:r||"Expanded view",className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl"}),r&&e.jsx("p",{className:"absolute bottom-[-3rem] left-0 right-0 text-center text-white/90 text-sm font-medium",children:r})]})]}),N=t.memo(({tool:t,active:s,strokes:n,onStrokeComplete:l,onEraseStroke:o,onStrokesUpdate:a,color:i="#ef4444",strokeWidth:d=3,eraserSize:c=30,isDarkMode:h=!1,highlightBlendMode:u})=>{const x=r.useRef(null),g=r.useRef(null),m=r.useRef(null),b=r.useRef(!1),p=r.useRef(!1),f=r.useRef([]),v=r.useRef(null),k=r.useRef([]),w=r.useRef(null),j=r.useRef(null),y=r.useRef(null),N=r.useRef(new Map),C=100,S="undefined"!=typeof window?Math.min(window.devicePixelRatio||1,2):1,M=(e,t)=>{if(e.startsWith("#")){const r=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return{r:r,g:s,b:n,rgba:`rgba(${r}, ${s}, ${n}, ${t})`}}const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(r){const e=Number(r[1]),s=Number(r[2]),n=Number(r[3]);return{r:e,g:s,b:n,rgba:`rgba(${e}, ${s}, ${n}, ${t})`}}return{r:255,g:212,b:0,rgba:`rgba(255, 212, 0, ${t})`}};r.useEffect(()=>{k.current=(n||[]).filter(e=>null!=e),E(),D()},[n]);const E=()=>{N.current.clear(),k.current.forEach((e,t)=>{if(!e)return;let r=e.bbox;if(!r&&e.points&&e.points.length>0){let t=1/0,s=1/0,n=-1/0,l=-1/0;for(const r of e.points)r.x<t&&(t=r.x),r.x>n&&(n=r.x),r.y<s&&(s=r.y),r.y>l&&(l=r.y);r={minX:t,minY:s,maxX:n,maxY:l},e.bbox=r}if(!r)return;const s=Math.floor(r.minX/C),n=Math.floor(r.minY/C),l=Math.floor(r.maxX/C),o=Math.floor(r.maxY/C);for(let a=s;a<=l;a++)for(let e=n;e<=o;e++){const r=`${a},${e}`;N.current.has(r)||N.current.set(r,new Set),N.current.get(r).add(t)}})},$=(e,t)=>{if(!t||!t.points||t.points.length<1)return;const r=t.points;if("rect-highlight"===t.tool){const s=t.color&&(t.color.includes("239")||t.color.includes("68")||t.color.includes("red")),n=t.color||(s?"#FF3B3B":"#FFD400"),{r:l,g:o,b:a}=M(n,1),i=h?.28:.14,d=h?.4:.2;e.globalCompositeOperation=h?"screen":"multiply",e.fillStyle=`rgba(${l}, ${o}, ${a}, ${i})`,e.shadowBlur=8,e.shadowColor=`rgba(${l}, ${o}, ${a}, 0.55)`;for(let t=0;t<r.length;t+=2)r[t+1]&&e.fillRect(r[t].x,r[t].y,r[t+1].x,r[t+1].y);e.globalCompositeOperation="screen",e.fillStyle=`rgba(${l}, ${o}, ${a}, ${d})`;for(let t=0;t<r.length;t+=2)r[t+1]&&e.fillRect(r[t].x,r[t].y,r[t+1].x,r[t+1].y);return e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}if(e.beginPath(),e.lineCap="round",e.lineJoin="round","pen"===t.tool)e.strokeStyle=t.color||"#ef4444",e.lineWidth=t.width||3,e.globalCompositeOperation="source-over";else if("highlighter"===t.tool){const r=t.color&&(t.color.includes("red")||t.color.includes("255, 60")),s=t.color||(r?"#FF3B3B":"#FFD400"),n=h?.32:.12,{r:l,g:o,b:a}=M(s,1);e.strokeStyle=`rgba(${l}, ${o}, ${a}, ${n})`,e.lineWidth=Math.max(t.width||12,9),e.lineCap="round",e.globalCompositeOperation=h?"screen":"multiply",e.shadowBlur=10,e.shadowColor=`rgba(${l}, ${o}, ${a}, 0.6)`}else"eraser"===t.tool&&(e.strokeStyle="white",e.lineWidth=t.width||30,e.globalCompositeOperation="destination-out");if(1===r.length){const t=r[0],s=Math.max((e.lineWidth||3)/2,1);return e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fillStyle=e.strokeStyle,e.fill(),e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}e.moveTo(r[0].x,r[0].y);for(let s=1;s<r.length-1;s++){const t=r[s],n=r[s+1],l={x:(t.x+n.x)/2,y:(t.y+n.y)/2};e.quadraticCurveTo(t.x,t.y,l.x,l.y)}e.lineTo(r[r.length-1].x,r[r.length-1].y),e.stroke(),e.shadowBlur=0,e.shadowColor="transparent",e.globalCompositeOperation="source-over"},D=r.useCallback(()=>{const e=x.current;if(!e)return;const t=e.getContext("2d",{alpha:!0});t&&(t.clearRect(0,0,e.width/S,e.height/S),k.current.forEach(e=>$(t,e)))},[S]),z=r.useCallback(()=>{const e=g.current;if(!e)return;const r=e.getContext("2d");r&&(r.clearRect(0,0,e.width/S,e.height/S),L.current&&(D(),L.current=!1),b.current&&("pen"===t||"highlighter"===t)&&f.current.length>0&&$(r,{tool:t,points:f.current,color:i,width:d}))},[S,t,i,d]);r.useEffect(()=>{const e=m.current,t=x.current,r=g.current;if(!e||!t||!r)return;const s=new ResizeObserver(e=>{for(const s of e){const{width:e,height:n}=s.contentRect;[t,r].forEach(t=>{t.width=e*S,t.height=n*S,t.style.width=`${e}px`,t.style.height=`${n}px`;const r=t.getContext("2d");r&&r.setTransform(S,0,0,S,0,0)}),D()}});return e.parentElement&&s.observe(e.parentElement),()=>s.disconnect()},[S,D]),r.useEffect(()=>{s&&D(),s||(b.current=!1,p.current=!1,f.current=[],v.current=null,j.current=null,y.current=null,w.current=null)},[s,n,D]);const P=e=>{const t=g.current;if(!t)return null;const r=t.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top}},L=r.useRef(!1),R=(e,t)=>{const r=((e,t)=>{const r=c/2+5,s=r*r,n=Math.floor(e/C),l=Math.floor(t/C),o=new Set;for(let i=-1;i<=1;i++)for(let e=-1;e<=1;e++){const t=N.current.get(`${n+i},${l+e}`);t&&t.forEach(e=>o.add(e))}const a=Array.from(o).sort((e,t)=>t-e);for(const i of a){const n=k.current[i];if(n&&n.points)if("rect-highlight"===n.tool)for(let r=0;r<n.points.length;r+=2){if(!n.points[r+1])continue;const l=n.points[r].x,o=n.points[r].y,a=n.points[r+1].x,d=n.points[r+1].y,c=e-Math.max(l,Math.min(e,l+a)),h=t-Math.max(o,Math.min(t,o+d));if(c*c+h*h<s)return i}else{const s=r+(n.width||3)/2,l=s*s;for(const r of n.points){const s=e-r.x,n=t-r.y;if(s*s+n*n<l)return i}}}return-1})(e,t);-1!==r&&(k.current=k.current.filter((e,t)=>t!==r),E(),L.current=!0,p.current=!0,o&&!a&&o(r))},T=e=>{if(b.current){try{e.target.releasePointerCapture(e.pointerId)}catch{}if(b.current=!1,f.current.length>0&&("pen"===t||"highlighter"===t)){const e=[...f.current];let r=1/0,s=1/0,n=-1/0,o=-1/0;for(const t of e)t.x<r&&(r=t.x),t.x>n&&(n=t.x),t.y<s&&(s=t.y),t.y>o&&(o=t.y);l({tool:t,points:e,color:i,width:d,bbox:{minX:r,minY:s,maxX:n,maxY:o}})}p.current&&a&&(a([...k.current]),p.current=!1),f.current=[],v.current=null,j.current=null,y.current=null,z()}};return e.jsxs("div",{ref:m,className:"absolute inset-0 z-20 pointer-events-none transition-opacity duration-300 "+(s?"opacity-100":"opacity-0"),children:[e.jsx("canvas",{ref:x,className:"absolute inset-0 touch-none pointer-events-none",style:{mixBlendMode:"highlighter"===t?u||(h?"screen":"multiply"):h?"multiply":"screen"}}),e.jsx("canvas",{ref:g,className:"absolute inset-0 touch-none "+(!s||"pen"!==t&&"eraser"!==t?"pointer-events-none":"pointer-events-auto"),style:{cursor:"eraser"===t?'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%20stroke%3D%22black%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M2%2016l9-9a2%202%200%200%201%203%200l6%206a2%202%200%200%201%200%203l-6%206H7l-5-5z%22/%3E%3Cpath%20d%3D%22M8%2021l6-6%22/%3E%3C/svg%3E") 12 12, auto':"crosshair",mixBlendMode:"highlighter"===t?u||(h?"screen":"multiply"):h?"multiply":"screen"},onPointerDown:e=>{if(!s)return;e.target.setPointerCapture(e.pointerId),b.current=!0;const r=P(e);r&&(w.current=r,f.current=[r],v.current=r,"highlighter"===t&&(j.current=null,y.current=r),"eraser"===t&&R(r.x,r.y),z())},onPointerMove:e=>{if(!s)return;const r=e.getCoalescedEvents?e.getCoalescedEvents():[e];let n=!1;for(const s of r){const e=P(s);if(e&&(w.current=e,b.current))if("eraser"===t)R(e.x,e.y),n=!0;else if("pen"===t||"highlighter"===t){let r=e;if("highlighter"===t&&y.current){if(!j.current){const t=Math.abs(e.x-y.current.x),r=Math.abs(e.y-y.current.y);(t>3||r>3)&&(j.current=t>=r?"horizontal":"vertical")}"horizontal"===j.current?r={x:e.x,y:y.current.y}:"vertical"===j.current&&(r={x:y.current.x,y:e.y})}(v.current?Math.pow(r.x-v.current.x,2)+Math.pow(r.y-v.current.y,2):100)>4&&(f.current.push(r),v.current=r,n=!0)}}n&&z()},onPointerUp:T,onPointerLeave:T,onPointerCancel:T})]})}),C=({fontSize:t,setFontSize:o,min:a=14,max:i=32})=>{const[d,c]=r.useState(!1),h=r.useRef(null);return r.useEffect(()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&c(!1)};return d&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[d]),e.jsxs("div",{ref:h,className:"fixed top-36 right-8 z-[100] isolate",children:[e.jsx("style",{children:"\n        .t-fab-shadow { box-shadow: 0 18px 50px rgba(0,0,0,0.55); }\n        .slider-bar-shadow { box-shadow: 0 18px 50px rgba(0,0,0,0.55); }\n        .gradient-chip { background: linear-gradient(180deg, #111a2a, #0f1726); }\n      "}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!0),className:`\n            w-[54px] h-[54px] rounded-full border border-white/15 text-white/90 \n            grid place-items-center cursor-pointer t-fab-shadow gradient-chip\n            transition-all duration-300 ease-out\n            ${d?"opacity-0 scale-90 pointer-events-none translate-y-[-6px]":"opacity-100 scale-100 translate-y-0"}\n          `,"aria-label":"Open text size control",children:e.jsx("span",{className:"font-bold text-lg tracking-wide",children:"T"})}),e.jsxs("div",{className:`\n            absolute top-0 right-0\n            h-[54px] rounded-full border border-white/15 \n            flex items-center gap-3 px-4 overflow-hidden slider-bar-shadow gradient-chip\n            transition-all duration-300 ease-out origin-right\n            ${d?"w-[320px] opacity-100 scale-100 translate-y-0 pointer-events-auto":"w-[54px] opacity-0 scale-90 translate-y-[-6px] pointer-events-none"}\n          `,children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),o(Math.max(a,t-2))},className:"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10 text-white/90 hover:bg-white/10 active:scale-95 transition-all flex-shrink-0",children:e.jsx(s,{size:16})}),e.jsx("input",{type:"range",min:a,max:i,value:t,onChange:e=>o(Number(e.target.value)),className:"flex-1 h-1.5 bg-white/15 rounded-full appearance-none cursor-pointer accent-blue-500"}),e.jsx("button",{onClick:e=>{e.stopPropagation(),o(Math.min(i,t+2))},className:"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10 text-white/90 hover:bg-white/10 active:scale-95 transition-all flex-shrink-0",children:e.jsx(n,{size:16})}),e.jsxs("div",{className:"flex items-center gap-1 text-white/90 flex-shrink-0 pl-1",children:[e.jsx(l,{size:18}),e.jsx("div",{className:"w-px h-4 bg-white/15 mx-2"}),e.jsxs("span",{className:"text-xs font-mono text-white/65 tabular-nums w-8 text-right",children:[t,"px"]})]})]})]})]})},S=(e,t,r=!1)=>{if(t.points.length<1)return;const{points:s,tool:n,color:l,size:o}=t;if(e.lineWidth=o,e.lineCap="round",e.lineJoin="round","eraser"===n)e.globalCompositeOperation="destination-out",e.strokeStyle="rgba(0,0,0,1)";else if("highlighter"===n){e.globalCompositeOperation=r?"screen":"multiply";const t=r?.32:.12,{r:s,g:n,b:o}=((e,t)=>{if(e.startsWith("#")){const r=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return{r:r,g:s,b:n,rgba:`rgba(${r}, ${s}, ${n}, ${t})`}}const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(r){const e=Number(r[1]),s=Number(r[2]),n=Number(r[3]);return{r:e,g:s,b:n,rgba:`rgba(${e}, ${s}, ${n}, ${t})`}}return{r:255,g:212,b:0,rgba:`rgba(255, 212, 0, ${t})`}})(l,1);e.strokeStyle=`rgba(${s}, ${n}, ${o}, ${t})`,e.shadowBlur=10,e.shadowColor=`rgba(${s}, ${n}, ${o}, 0.6)`}else e.globalCompositeOperation="source-over",e.strokeStyle=l;if(1===t.points.length){const t=s[0],r=Math.max(o/2,1);return e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fillStyle="eraser"===n?"rgba(0,0,0,1)":"highlighter"===n?e.strokeStyle:l,e.fill(),e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}e.beginPath(),e.moveTo(s[0].x,s[0].y);for(let i=1;i<s.length-1;i++){const t=s[i],r=s[i+1],n={x:(t.x+r.x)/2,y:(t.y+r.y)/2};e.quadraticCurveTo(t.x,t.y,n.x,n.y)}const a=s[s.length-1];e.lineTo(a.x,a.y),e.stroke(),e.shadowBlur=0,e.shadowColor="transparent",e.globalCompositeOperation="source-over"},M=(e,t)=>{const r=t.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top,pressure:e.pressure}},E=({currentTool:t,strokes:s,setStrokes:n,currentColor:l="#FCD34D",isDarkMode:o=!1})=>{const a=r.useRef(null),i=r.useRef(null),d=r.useRef(null),c=r.useRef(!1),h=r.useRef(null),u=r.useRef(s),x=r.useRef(null),g=r.useRef(null),m=r.useRef(null),b={select:{color:l,size:0},pen:{color:l,size:3},highlighter:{color:l,size:14},eraser:{color:"rgb(0,0,0)",size:30}},p=r.useCallback(()=>{if(!a.current)return;const e=a.current.getContext("2d");e&&(e.clearRect(0,0,a.current.width,a.current.height),u.current.forEach(t=>{S(e,t,o)}))},[o]),f=r.useCallback(()=>{if(!i.current)return;const e=i.current.getContext("2d");e&&e.clearRect(0,0,i.current.width,i.current.height)},[o]);r.useEffect(()=>{const e=()=>{if(!a.current||!i.current||!d.current)return;const e=d.current,t="undefined"!=typeof window?Math.min(window.devicePixelRatio||1,2):1;[a.current,i.current].forEach(r=>{r.width=e.clientWidth*t,r.height=e.clientHeight*t,r.style.width=`${e.clientWidth}px`,r.style.height=`${e.clientHeight}px`;const s=r.getContext("2d");s&&s.setTransform(t,0,0,t,0,0)}),p(),f()};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[p,f]),r.useEffect(()=>{u.current=s,p(),f()},[s,p,f]);const v=e=>{if(!c.current)return;i.current&&i.current.releasePointerCapture(e.pointerId),c.current=!1;const t=h.current;if(t){const e=[...u.current,t];u.current=e,n(e)}h.current=null,x.current=null,g.current=null,m.current=null,p(),f()};return e.jsxs("div",{ref:d,className:"absolute inset-0 w-full h-full",style:{cursor:"select"===t?"default":"eraser"===t?'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%20stroke%3D%22black%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M2%2016l9-9a2%202%200%200%201%203%200l6%206a2%202%200%200%201%200%203l-6%206H7l-5-5z%22/%3E%3Cpath%20d%3D%22M8%2021l6-6%22/%3E%3C/svg%3E") 12 12, auto':"crosshair"},children:[e.jsx("canvas",{ref:a,className:"absolute inset-0 block pointer-events-none"}),e.jsx("canvas",{ref:i,className:"absolute inset-0 block touch-none",onPointerDown:e=>{var r,s;if(!i.current)return;if("select"===t)return;i.current.setPointerCapture(e.pointerId);const n=M(e,i.current),l=b[t];c.current=!0,h.current={points:[n],tool:t,color:l.color,size:l.size},x.current=n,"highlighter"===t&&(g.current=null,m.current=n);const d="eraser"===t?null==(r=a.current)?void 0:r.getContext("2d"):null==(s=i.current)?void 0:s.getContext("2d");d&&S(d,h.current,o)},onPointerMove:e=>{var r,s;if(!c.current||!i.current||"select"===t)return;const n=e.getCoalescedEvents?e.getCoalescedEvents():[e],l=h.current;if(l)for(const d of n){const e=M(d,i.current);let n=e;if("highlighter"===t&&m.current){if(!g.current){const t=Math.abs(e.x-m.current.x),r=Math.abs(e.y-m.current.y);(t>3||r>3)&&(g.current=t>=r?"horizontal":"vertical")}"horizontal"===g.current?n={x:e.x,y:m.current.y}:"vertical"===g.current&&(n={x:m.current.x,y:e.y})}const c=x.current;if(c){const e=n.x-c.x,t=n.y-c.y;if(e*e+t*t<4)continue}l.points.push(n);const h="eraser"===t?null==(r=a.current)?void 0:r.getContext("2d"):null==(s=i.current)?void 0:s.getContext("2d");h&&c&&S(h,{...l,points:[c,n]},o),x.current=n}},onPointerUp:v,onPointerLeave:v})]})},$=({isActive:t,currentTool:r,highlightMode:s="freehand",strokes:n,setStrokes:l,currentColor:o,isDarkMode:a=!1})=>t?e.jsx("div",{className:"absolute inset-0 z-[200] pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 "+("select"===r||"highlighter"===r&&"text"===s?"pointer-events-none":"pointer-events-auto"),children:e.jsx(E,{currentTool:r,strokes:n,setStrokes:l,currentColor:o,isDarkMode:a})})}):null,D=[{name:"Yellow",value:"#FCD34D",bg:"bg-yellow-400"},{name:"Mint",value:"#6EE7B7",bg:"bg-emerald-300"},{name:"Red",value:"#EF4444",bg:"bg-red-500"},{name:"White",value:"#FFFFFF",bg:"bg-white",className:"border border-slate-300"},{name:"Black",value:"#111827",bg:"bg-slate-900"}],z=({currentTool:t,setTool:n,onUndo:x,onClear:g,canUndo:m,onClose:b,currentColor:p="#FCD34D",onColorChange:f,highlightMode:v="freehand",onHighlightModeChange:k})=>{const[w,j]=r.useState(!1),y="eraser"===t,N=e=>t=>{t.preventDefault(),n(e)},C=e=>t=>{t.preventDefault(),null==k||k(e)};return w?e.jsx("button",{onPointerDown:e=>{e.preventDefault(),j(!1)},onClick:()=>j(!1),className:"w-12 h-12 rounded-full bg-white/95 dark:bg-slate-900/95 border border-slate-200 dark:border-slate-700 shadow-xl backdrop-blur-xl flex items-center justify-center text-slate-700 dark:text-slate-200 hover:scale-105 transition-transform",title:"Open toolbar",children:e.jsx(o,{size:18,strokeWidth:2})}):e.jsxs("div",{className:"flex items-center gap-2 bg-white/95 dark:bg-slate-900/95 border border-slate-200 dark:border-slate-700 rounded-2xl px-4 py-2 shadow-xl backdrop-blur-xl touch-manipulation",children:[e.jsx("button",{onPointerDown:e=>{e.preventDefault(),j(!0)},onClick:()=>j(!0),className:"p-2 rounded-full transition-all text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800",title:"Collapse toolbar",children:e.jsx(a,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:N("select"),onClick:()=>n("select"),className:"p-2 rounded-full transition-all "+("select"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Select",children:e.jsx(i,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:N("pen"),onClick:()=>n("pen"),className:"p-2 rounded-full transition-all "+("pen"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Pen",children:e.jsx(o,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:N("eraser"),onClick:()=>n("eraser"),className:"p-2 rounded-full transition-all "+("eraser"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Eraser",children:e.jsx(d,{size:18,strokeWidth:2,className:"transition-transform "+(y?"scale-125":"scale-100")})}),e.jsx("button",{onPointerDown:N("highlighter"),onClick:()=>n("highlighter"),className:"p-2 rounded-full transition-all "+("highlighter"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Highlighter",children:e.jsx(s,{size:18,strokeWidth:3})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),"highlighter"===t&&k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onPointerDown:C("text"),onClick:()=>k("text"),className:"p-2 rounded-full transition-all "+("text"===v?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Text highlight",children:e.jsx(l,{size:16,strokeWidth:2})}),e.jsx("button",{onPointerDown:C("freehand"),onClick:()=>k("freehand"),className:"p-2 rounded-full transition-all "+("freehand"===v?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Freehand highlight",children:e.jsx(o,{size:16,strokeWidth:2})})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:D.map(t=>{return e.jsx("button",{onPointerDown:(r=t.value,e=>{e.preventDefault(),null==f||f(r)}),onClick:()=>null==f?void 0:f(t.value),className:`w-7 h-7 rounded-full transition-all hover:scale-110 ${t.bg} ${t.className||""} ${p===t.value?"ring-2 ring-blue-500 ring-offset-2 ring-offset-white dark:ring-offset-slate-900":"hover:ring-2 hover:ring-slate-300 dark:hover:ring-slate-600"}`,title:t.name},t.value);var r})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("div",{className:"p-2 rounded-full text-slate-500 dark:text-slate-400",children:e.jsx(c,{size:18,strokeWidth:2})}),e.jsx("button",{onClick:x,disabled:!m,className:"p-2 rounded-full transition-all "+(m?"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800":"text-slate-300 dark:text-slate-700 cursor-not-allowed"),title:"Undo",children:e.jsx(h,{size:18,strokeWidth:2})}),e.jsx("button",{onClick:g,className:"p-2 rounded-full transition-all text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800",title:"Clear All",children:e.jsx(u,{size:18,strokeWidth:2})})]})},P=({onInsert:t,onSave:s,onCancel:n})=>{const l=r.useRef(null);return e.jsxs("div",{className:"sticky top-4 z-50 mb-6 bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-white/10 p-3 flex flex-wrap items-center gap-2 animate-in slide-in-from-top-4",children:[e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("**","**"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold",title:"Bold",children:"B"}),e.jsx("button",{onClick:()=>t("*","*"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 italic",title:"Italic",children:"I"}),e.jsx("button",{onClick:()=>t('<span style="color: red">',"</span>"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-red-500 font-bold",title:"Red Text",children:"A"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("# "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-lg",title:"Heading 1",children:"H1"}),e.jsx("button",{onClick:()=>t("## "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-base",title:"Heading 2",children:"H2"}),e.jsx("button",{onClick:()=>t("### "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-sm",title:"Heading 3",children:"H3"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("- "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Bullet List",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("button",{onClick:()=>t("1. "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Numbered List",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h12M7 12h12M7 17h12M3 7h1m-1 5h1m-1 5h1"})})})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:e=>{var r;const s=null==(r=e.target.files)?void 0:r[0];if(!s)return;const n=new FileReader;n.onload=e=>{var r;const n=null==(r=e.target)?void 0:r.result,l=`![${s.name}](${n})`;t(l)},n.readAsDataURL(s),l.current&&(l.current.value="")},className:"hidden"}),e.jsx("button",{onClick:()=>{var e;return null==(e=l.current)?void 0:e.click()},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Upload Image",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:s,className:"px-6 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-bold shadow-lg shadow-emerald-500/20 transition-all hover:scale-105",children:"Save Changes"})]})]})},L=()=>{const[t,s]=r.useState("closed"),[n,l]=r.useState(null);return e.jsxs("div",{className:"flex flex-col bg-slate-50 dark:bg-slate-900/50 rounded-2xl border border-slate-200 dark:border-white/10 p-4 md:p-8",children:[e.jsxs("div",{className:"max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"TMJ Dynamics"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-2",children:"Ginglymoarthrodial Joint Mechanics"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-white/10",children:[e.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-4",children:"Anatomy Selector"}),e.jsx("div",{className:"space-y-2",children:[{id:"temporal",name:"Temporal Bone (Fossa/Eminence)",color:"#94a3b8",description:"Mandibular fossa and articular eminence. Provides the superior surface for the joint."},{id:"disc",name:"Articular Disc",color:"#38bdf8",description:"Fibrocartilage dividing the joint into superior (translation) and inferior (rotation) compartments."},{id:"condyle",name:"Mandibular Condyle",color:"#f87171",description:'The "ball" of the joint. Rotates against the disc in early opening.'},{id:"capsule",name:"Fibrous Capsule & Synovial Membrane",color:"#fbbf24",description:"Encloses the joint. Synovial membrane lines the inner surface, producing lubricating fluid."}].map(t=>e.jsxs("button",{onClick:()=>l(n===t.id?null:t.id),className:"w-full text-left px-4 py-3 rounded-lg transition-all border "+(n===t.id?"bg-slate-900 text-white border-slate-900 shadow-md":"bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 border-slate-200 dark:border-slate-700 hover:border-slate-400 dark:hover:border-slate-500"),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:t.name}),n===t.id?e.jsx(x,{size:18}):e.jsx(a,{size:18})]}),n===t.id&&e.jsx("p",{className:"mt-2 text-xs opacity-90 leading-relaxed border-t border-white/20 pt-2",children:t.description})]},t.id))})]}),e.jsxs("div",{className:"bg-blue-900 text-white p-6 rounded-xl shadow-lg",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(g,{size:20})," Movement Phase"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>s("closed"),className:"py-2 px-1 rounded text-xs font-bold transition "+("closed"===t?"bg-white text-blue-900":"bg-blue-800 hover:bg-blue-700"),children:"CLOSED"}),e.jsx("button",{onClick:()=>s("early"),className:"py-2 px-1 rounded text-xs font-bold transition "+("early"===t?"bg-white text-blue-900":"bg-blue-800 hover:bg-blue-700"),children:"ROTATION"}),e.jsx("button",{onClick:()=>s("wide"),className:"py-2 px-1 rounded text-xs font-bold transition "+("wide"===t?"bg-white text-blue-900":"bg-blue-800 hover:bg-blue-700"),children:"WIDE (GLIDE)"})]}),e.jsxs("div",{className:"mt-6 space-y-3 text-sm",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-blue-700 "+("early"===t?"bg-blue-800 ring-2 ring-white/50":"opacity-60"),children:[e.jsxs("div",{className:"font-bold flex items-center gap-2",children:[e.jsx(h,{size:14})," Inferior Compartment"]}),e.jsx("p",{className:"text-xs mt-1",children:"Hinge-like rotation occurs between the condyle and the disc. Initial opening (up to ~20mm)."})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-blue-700 "+("wide"===t?"bg-blue-800 ring-2 ring-white/50":"opacity-60"),children:[e.jsxs("div",{className:"font-bold flex items-center gap-2",children:[e.jsx(g,{size:14})," Superior Compartment"]}),e.jsx("p",{className:"text-xs mt-1",children:"Translation (glide) occurs as the disc-condyle complex moves forward along the articular eminence."})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 relative bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-white/10 overflow-hidden min-h-[500px] flex flex-col",children:[e.jsxs("div",{className:"absolute top-4 right-4 z-10 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold bg-white/80 dark:bg-slate-800/80 backdrop-blur p-2 rounded border border-slate-200 dark:border-white/10 shadow-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full"})," Condyle"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold bg-white/80 dark:bg-slate-800/80 backdrop-blur p-2 rounded border border-slate-200 dark:border-white/10 shadow-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-sky-400 rounded-full"})," Articular Disc"]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("svg",{viewBox:"0 0 500 400",className:"w-full h-full max-w-[500px]",children:[e.jsx("text",{x:"50",y:"30",className:"text-[10px] fill-slate-300 font-bold uppercase",children:"Posterior"}),e.jsx("text",{x:"400",y:"30",className:"text-[10px] fill-slate-300 font-bold uppercase",children:"Anterior"}),e.jsx("path",{d:"M50,100 Q150,100 200,120 T350,180 L450,180 L450,50 L50,50 Z",fill:"temporal"===n?"#475569":"#e2e8f0",stroke:"#94a3b8",strokeWidth:"2"}),e.jsx("text",{x:"250",y:"80",className:"text-[12px] fill-slate-500 font-bold",children:"Temporal Bone (Cranial Base)"}),e.jsx("path",{d:"M200,120 T350,180",fill:"none",stroke:"#64748b",strokeWidth:"4",strokeLinecap:"round",className:"temporal"===n?"animate-pulse":""}),e.jsx("path",{d:"M160,100 Q140,200 180,280 Q250,300 320,280 Q360,180 340,140",fill:"none",stroke:"#fbbf24",strokeWidth:"2",strokeDasharray:"4 2",opacity:"capsule"===n?1:.3}),e.jsxs("g",{style:{transition:"all 0.8s cubic-bezier(0.4, 0, 0.2, 1)",transform:(()=>{switch(t){case"early":return"rotate(15deg) translate(5px, 2px)";case"wide":return"rotate(25deg) translate(45px, 15px)";default:return"rotate(0deg) translate(0, 0)"}})(),transformOrigin:"210px 150px"},children:[e.jsx("path",{d:"M180,180 Q170,250 160,350 L280,380 L290,280 Z",fill:"condyle"===n?"#ef4444":"#fecaca",stroke:"#ef4444",strokeWidth:"2"}),e.jsx("ellipse",{cx:"210",cy:"165",rx:"35",ry:"25",fill:"condyle"===n?"#ef4444":"#fecaca",stroke:"#ef4444",strokeWidth:"2"}),"closed"===t&&e.jsx("path",{d:"M185,145 Q210,135 235,145",fill:"none",stroke:"#fbbf24",strokeWidth:"1",opacity:"0.5"})]}),e.jsxs("g",{style:{transition:"all 0.8s cubic-bezier(0.4, 0, 0.2, 1)",transform:(()=>{switch(t){case"early":return"translate(2px, 1px) rotate(5deg)";case"wide":return"translate(30px, 10px) rotate(15deg)";default:return"translate(0, 0) rotate(0deg)"}})(),transformOrigin:"210px 150px"},children:[e.jsx("path",{d:"M160,140 Q210,115 260,145 L255,155 Q210,135 165,150 Z",fill:"disc"===n?"#0284c7":"#7dd3fc",stroke:"#0ea5e9",strokeWidth:"2"}),"disc"===n&&e.jsxs(e.Fragment,{children:[e.jsx("text",{x:"180",y:"105",className:"text-[10px] fill-blue-600 font-bold",children:"Superior Compartment (Translation)"}),e.jsx("text",{x:"180",y:"180",className:"text-[10px] fill-red-600 font-bold",children:"Inferior Compartment (Rotation)"})]})]}),"early"===t&&e.jsx("path",{d:"M160,180 Q130,220 150,260",fill:"none",stroke:"#ef4444",strokeWidth:"2",markerEnd:"url(#arrow)"}),"wide"===t&&e.jsx("path",{d:"M280,120 L350,160",fill:"none",stroke:"#0ea5e9",strokeWidth:"3",markerEnd:"url(#arrow)"}),e.jsx("defs",{children:e.jsx("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"currentColor"})})})]})}),e.jsx("div",{className:"bg-slate-900 p-6 text-white",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-white/10 p-2 rounded-lg",children:e.jsx(m,{size:24,className:"text-blue-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold italic text-blue-200",children:"closed"===t?"Centric Relation / Occlusion":"early"===t?"Phase 1: Ginglymus (Hinge)":"Phase 2: Arthrodial (Glide)"}),e.jsxs("p",{className:"text-sm text-slate-300 mt-1 leading-relaxed",children:["closed"===t&&"The condyle sits comfortably in the mandibular fossa. The disc's thin intermediate zone is between the articulating surfaces.","early"===t&&"Pure rotation occurs in the inferior joint compartment. The disc stays relatively stable while the condyle rotates like a hinge.","wide"===t&&"The entire disc-condyle complex translates forward and downward along the articular eminence in the superior compartment."]})]})]})})]})]}),e.jsx("footer",{className:"mt-8 text-center text-slate-400 text-xs",children:e.jsx("p",{children:"TMJ Schematic Diagram & Mechanics Educational Tool â€¢ Ginglymoarthrodial Joint Anatomy"})})]})},R={},T=e=>{if(!e)return{r:255,g:212,b:0};if(e.startsWith("#")&&e.length>=7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)};const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);return t?{r:Number(t[1]),g:Number(t[2]),b:Number(t[3])}:{r:255,g:212,b:0}},I=(()=>{try{return new RegExp("(?<=a)b"),new RegExp("\\p{P}","u"),!0}catch{return!1}})(),B=t.memo(({content:t,setSelectedImage:r})=>{const s=t.includes("KEEP_STYLE"),n=t.replace("\x3c!--KEEP_STYLE--\x3e","").replace(/<head[\s\S]*?<\/head>/gi,"").replace(s?/$^/:/<style[\s\S]*?<\/style>/gi,"").replace(/<meta[^>]*>/gi,"").replace(/<\/?html[^>]*>/gi,"").replace(/<\/?body[^>]*>/gi,"").replace(/@import\s+url\([^)]*\);?/gi,"").replace(/<img([^>]*)style="[^"]*"([^>]*)>/g,"<img$1$2>");return e.jsx("div",{className:"osteology-html-content",onClick:e=>{const t=e.target;if("IMG"===t.tagName){const e=t.src;e&&r(e)}},dangerouslySetInnerHTML:{__html:n}})},(e,t)=>e.content===t.content),W=t.memo(({content:t,setSelectedImage:r,isGIC:s})=>e.jsx(b,{remarkPlugins:I?[j]:[],rehypePlugins:[w],components:{img:({node:t,...s})=>e.jsxs("div",{className:"my-10 relative group select-none",children:[e.jsx("div",{className:"absolute inset-0 z-40 bg-transparent",onContextMenu:e=>e.preventDefault()}),s.src&&s.src.includes("impression_downloadable_summary.png")&&e.jsxs("a",{href:s.src,download:"Impression_Materials_Summary.png",onClick:e=>e.stopPropagation(),className:"absolute top-4 right-4 bg-white/90 dark:bg-slate-800/90 text-slate-900 dark:text-white px-4 py-2 rounded-lg font-bold shadow-lg z-[60] hover:bg-white dark:hover:bg-slate-700 transition-colors flex items-center gap-2 pointer-events-auto cursor-pointer border border-slate-200 dark:border-white/10",title:"Download Summary Table",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]}),e.jsx("img",{...s,onClick:()=>s.src&&r(s.src),className:"rounded-2xl shadow-xl border border-slate-200 dark:border-white/10 w-full max-w-[800px] mx-auto object-contain transition-transform hover:scale-[1.01] duration-500 cursor-zoom-in relative z-30 select-none pointer-events-auto bg-white",draggable:!1,alt:s.alt||"Medical Diagram",style:{display:"block"}}),s.alt&&e.jsx("p",{className:"text-center text-base text-slate-500 dark:text-slate-400 mt-4 font-sans font-medium",children:s.alt})]}),table:({node:t,...r})=>e.jsx("div",{className:"overflow-x-auto my-6 border border-slate-300 dark:border-slate-600 rounded-lg",children:e.jsx("table",{...r,className:"min-w-full text-left border-collapse bg-white dark:bg-slate-900"})}),thead:({node:t,...r})=>e.jsx("thead",{...r,className:"bg-slate-100 dark:bg-slate-800"}),th:({node:t,...r})=>e.jsx("th",{...r,className:"px-6 py-4 border border-slate-300 dark:border-slate-600 font-bold text-slate-900 dark:text-white bg-slate-100 dark:bg-slate-800 text-sm md:text-base align-top"}),td:({node:t,...r})=>e.jsx("td",{...r,className:"px-6 py-4 border border-slate-300 dark:border-slate-600 text-slate-800 dark:text-slate-200 align-top "+(s?"text-lg md:text-xl":"text-sm md:text-base")}),h1:({node:t,...r})=>e.jsx("h1",{...r,className:"medical-serif text-3xl md:text-4xl font-black mb-8 text-slate-900 dark:text-white tracking-tight"}),h2:({node:t,...r})=>e.jsxs("div",{className:"mt-16 mb-8 pt-8 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-slate-300 dark:via-white/20 to-transparent"}),e.jsx("h2",{...r,className:"medical-serif text-2xl md:text-3xl font-bold text-slate-900 dark:text-white"})]}),h3:({node:t,...r})=>e.jsx("h3",{...r,className:"medical-serif text-xl md:text-2xl font-bold mt-10 mb-5 text-slate-800 dark:text-slate-200"}),ol:({node:t,...r})=>e.jsx("ol",{...r,className:"space-y-3 my-6 list-decimal pl-8"}),ul:({node:t,...r})=>e.jsx("ul",{...r,className:"space-y-3 my-6 list-disc pl-8 marker:text-slate-500"}),strong:({node:t,...r})=>e.jsx("strong",{...r,className:"font-bold text-slate-900 dark:text-white"}),hr:({node:t,...r})=>e.jsx("div",{className:"my-14 h-px bg-gradient-to-r from-transparent via-slate-300 dark:via-white/20 to-transparent"}),iframe:({node:t,...r})=>e.jsx("div",{className:"my-10 relative w-full aspect-video rounded-2xl overflow-hidden shadow-xl border border-slate-200 dark:border-white/10",children:e.jsx("iframe",{...r,className:"absolute inset-0 w-full h-full"})}),video:({node:t,...r})=>e.jsx("div",{className:"my-10 relative w-full rounded-2xl overflow-hidden shadow-xl border border-slate-200 dark:border-white/10",children:e.jsx("video",{...r,className:"w-full",controls:!0})}),p:({node:t,...r})=>e.jsx("div",{...r,className:s?"text-lg md:text-xl leading-relaxed mb-6":"mb-4"}),li:({node:t,...r})=>e.jsx("li",{...r,className:s?"text-lg md:text-xl leading-relaxed mb-3":"mb-2"}),a:k},children:t}),(e,t)=>e.content===t.content&&e.isGIC===t.isGIC),F=({subject:t,topic:s,stream:n,onStartQuiz:l,onBack:o,isDarkMode:a,onPageContentChange:i,isAdmin:c})=>{const[h,u]=r.useState(null),[x,g]=r.useState(!0),[m,b]=r.useState(!1),[k,w]=r.useState(null),[j,S]=r.useState(!1),[M,E]=r.useState("pen"),[D,I]=r.useState([]),[F,O]=r.useState("yellow"),[A,H]=r.useState("#ef4444"),[_,U]=r.useState(3),[J,Y]=r.useState(30),[Q,G]=r.useState(18),[X,q]=r.useState(!1),[K,V]=r.useState("pen"),[Z,ee]=r.useState([]),[te,re]=r.useState("#FCD34D"),[se,ne]=r.useState("freehand"),[le,oe]=r.useState(!1),[ae,ie]=r.useState(""),[de,ce]=r.useState([]),[he,ue]=r.useState(0),[xe,ge]=r.useState(!1),me=X&&"highlighter"===K&&"text"===se,be=j&&"highlighter"===M||me,pe=me?te:"yellow"===F?"#FFD400":"#FF3B3B",fe=((e,t)=>{const{r:r,g:s,b:n}=T(e);return`rgba(${r}, ${s}, ${n}, ${t?.2:.12})`})(pe,Boolean(a)),ve=((e,t)=>{const{r:r,g:s,b:n}=T(e);return`rgba(${r}, ${s}, ${n}, ${t?.6:.45})`})(pe,Boolean(a)),ke=be?{"--selection-bg":fe,"--selection-fg":"currentColor","--selection-glow":ve}:void 0,we=r.useMemo(()=>D.filter(e=>"rect-highlight"===e.tool).length,[D]),je=(s||"").toLowerCase(),ye=t===f.ANATOMY&&(je.includes("tmj")||je.includes("temporomandibular")),Ne=`dentedge_study_v1_${t}_${s||"main"}`,Ce=e=>{I(t=>{const r=e(t);if(0===r.length)try{localStorage.removeItem(Ne)}catch{}return r})},Se=me?()=>{Ce(e=>{const t=[...e].reverse().findIndex(e=>"rect-highlight"===e.tool);if(-1===t)return e;const r=e.length-1-t;return e.filter((e,t)=>t!==r)})}:()=>ee(e=>e.slice(0,-1)),Me=me?()=>{Ce(e=>e.filter(e=>"rect-highlight"!==e.tool))}:()=>ee([]),Ee=me?we>0:Z.length>0;r.useEffect(()=>{try{const t=localStorage.getItem(Ne);if(t)try{const{savedStrokes:e}=JSON.parse(t);e&&I(e)}catch(e){}}catch(e){}},[Ne]),r.useEffect(()=>{if(D.length>0)try{localStorage.setItem(Ne,JSON.stringify({savedStrokes:D}))}catch(e){}},[D,Ne]),r.useEffect(()=>{const e=()=>{if(!be)return;const e=window.getSelection();if(!e||0===e.rangeCount)return;const t=e.getRangeAt(0);if(e.toString().trim().length>2){const e=document.getElementById("content-area");if(!e)return;const r=e.getBoundingClientRect(),s=t.getClientRects(),n=[];for(let t=0;t<s.length;t++){const e=s[t];n.push({x:e.left-r.left,y:e.top-r.top}),n.push({x:e.width,y:e.height})}if(n.length>0){const e={tool:"rect-highlight",points:n,color:pe,width:0};I(t=>[...t,e]),setTimeout(()=>{var e;window.getSelection&&(null==(e=window.getSelection())||e.removeAllRanges())},100)}}};return document.addEventListener("mouseup",e),document.addEventListener("touchend",e),()=>{document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)}},[be,pe]),r.useEffect(()=>{let e,r=!1,l=!1;g(!0),ge(!1);return(async()=>{let o;const a={subject:t,content:"Loading timed out. Please go back and open the topic again.",keyPoints:[]};try{if(ye){const e={subject:t,content:"TMJ interactive view",keyPoints:["Inferior compartment: early opening uses hinge-like rotation.","Superior compartment: wide opening adds anterior translation.","Disc-condyle coordination is essential for smooth TMJ function."]};return u(e),b(!0),void(i&&i(e.content))}e=window.setTimeout(()=>{r||(l=!0,u(a),b(!1),g(!1))},3e4);const c=new Promise(e=>{o=window.setTimeout(()=>e(a),2e4)}),h=await Promise.race([v(t,n,s),c]);if(void 0!==o&&window.clearTimeout(o),r||l)return;const x=`${t}|${s||""}`,m=localStorage.getItem(`dentedge_edit_${x}`);if(m)try{const e=JSON.parse(m);h.content=e.content,h.keyPoints=e.keyPoints}catch(d){}else if(x in R){const e=R[x];e&&"content"in e&&"keyPoints"in e&&(h.content=e.content,h.keyPoints=e.keyPoints)}u(h),b(!1),i&&(null==h?void 0:h.content)&&i(h.content)}catch(c){r||l||u({subject:t,content:"Unable to load content. Please try again.",keyPoints:[]})}finally{void 0!==o&&window.clearTimeout(o),void 0!==e&&window.clearTimeout(e),r||l||g(!1)}})(),()=>{r=!0,void 0!==e&&window.clearTimeout(e)}},[t,n,s,he,ye,i]),r.useEffect(()=>{if(!x)return void ge(!1);const e=window.setTimeout(()=>ge(!0),8e3);return()=>{window.clearTimeout(e)}},[x,t,n,s,he]),r.useEffect(()=>{if(!(null==h?void 0:h.content))return;let e=!1;const t=()=>{e||b(!0)},r=window.requestIdleCallback,s=window.cancelIdleCallback;if(r&&s){const n=r(t,{timeout:120});return()=>{e=!0,s(n)}}const n=window.setTimeout(t,0);return()=>{e=!0,window.clearTimeout(n)}},[null==h?void 0:h.content]);const $e=`${t}|${s||""}`;return x?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[600px]",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-purple-500"}),e.jsx("p",{className:"mt-4 font-bold text-slate-500",children:"Loading Notes..."}),xe&&e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{u(null),b(!1),ge(!1),ue(e=>e+1)},className:"px-4 py-2 rounded-xl border border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:"Retry"}),e.jsx("button",{onClick:o,className:"px-4 py-2 rounded-xl bg-slate-700 text-white hover:bg-slate-800 transition-colors",children:"Back"})]})]}):h?e.jsxs("div",{className:"max-w-[1600px] mx-auto pb-24 px-4 sm:px-6 relative",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-10 py-4 justify-between border-b dark:border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:o,className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:s||t})]}),c&&!le&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{h&&(ie(h.content),ce([...h.keyPoints]),oe(!0))},className:"p-2 text-slate-400 hover:text-purple-600 dark:hover:text-purple-400 transition-colors",title:"Edit content",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>{const e={...R};for(const l of Object.keys(localStorage))if(l.startsWith("dentedge_edit_"))try{e[l.replace("dentedge_edit_","")]=JSON.parse(localStorage.getItem(l))}catch(n){}const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download="contentOverrides.json",s.click(),URL.revokeObjectURL(r)},className:"p-2 text-slate-400 hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors",title:"Export all overrides for deploy",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 relative",children:[e.jsx("div",{className:"lg:col-span-9",children:le?e.jsxs("section",{className:"p-0 rounded-none bg-transparent border-none shadow-none relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx(P,{onInsert:(e,t)=>{const r=document.getElementById("admin-edit-textarea");if(!r)return;const s=r.selectionStart,n=r.selectionEnd;t?(ie(r=>r.slice(0,s)+e+r.slice(s,n)+t+r.slice(n)),requestAnimationFrame(()=>{r.selectionStart=s+e.length,r.selectionEnd=s+e.length+(n-s),r.focus()})):(ie(t=>t.slice(0,s)+e+t.slice(n)),requestAnimationFrame(()=>{r.selectionStart=s+e.length,r.selectionEnd=s+e.length,r.focus()}))},onSave:()=>{localStorage.setItem(`dentedge_edit_${$e}`,JSON.stringify({content:ae,keyPoints:de})),h&&u({...h,content:ae,keyPoints:de}),oe(!1)},onCancel:()=>oe(!1)})}),e.jsx("textarea",{id:"admin-edit-textarea",value:ae,onChange:e=>ie(e.target.value),className:"w-full h-[650px] p-6 text-slate-800 dark:text-slate-100 leading-8 text-base bg-white dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Edit content here..."}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Key Points"}),e.jsx("textarea",{value:de.join("\n"),onChange:e=>ce(e.target.value.split("\n").filter(Boolean)),className:"w-full h-[140px] p-4 text-slate-800 dark:text-slate-100 leading-7 text-base bg-white dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"One key point per line..."})]})]}):e.jsx("section",{className:"glass-panel p-10 md:p-14 rounded-[2.5rem] bg-white dark:bg-black border border-slate-100 dark:border-white/5 shadow-sm dark:shadow-none relative",children:e.jsxs("div",{className:"relative",id:"content-area",children:[e.jsx(N,{tool:j?M:"highlighter",active:j||be,strokes:D,onStrokeComplete:e=>I(t=>[...t,e]),onEraseStroke:e=>I(t=>t.filter((t,r)=>r!==e)),onStrokesUpdate:e=>I(e),color:A,strokeWidth:_,eraserSize:J,highlightBlendMode:me?"screen":void 0,isDarkMode:a}),ye?e.jsx(L,{}):m?e.jsx("div",{className:"prose-sm prose-slate dark:prose-invert max-w-none text-slate-800 dark:text-slate-200 leading-7 md:leading-8 "+(be?"allow-selection cursor-text":"select-none"),style:{fontSize:`${Q}px`,...ke||{}},onContextMenu:e=>e.preventDefault(),onCopy:e=>{be&&(e.preventDefault(),alert("Content copying is disabled to protect medical data."))},children:(De=h.content,De.trimStart().startsWith("<html")||De.trimStart().startsWith("<style")||De.includes("<html")?e.jsx(B,{content:h.content,setSelectedImage:w}):e.jsx(W,{content:h.content,setSelectedImage:w,isGIC:(null==s?void 0:s.toLowerCase().includes("gic"))||h.subject===f.DENTAL_MATERIALS&&(null==s?void 0:s.toLowerCase().includes("glass"))}))}):e.jsxs("div",{className:"min-h-[420px] flex flex-col items-center justify-center gap-3 text-slate-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-slate-400"}),e.jsx("p",{className:"text-sm font-semibold",children:"Preparing notesâ€¦"})]}),e.jsx($,{isActive:X,currentTool:K,highlightMode:se,strokes:Z,setStrokes:ee,currentColor:te,isDarkMode:a})]})})}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"p-6 bg-amber-50 dark:bg-amber-900/10 rounded-3xl border border-amber-200 dark:border-amber-500/20",children:[e.jsx("h3",{className:"font-bold text-amber-600 mb-4 text-lg",children:"Quick Pearls"}),e.jsx("ul",{className:"space-y-3 text-base",children:h.keyPoints.map((t,r)=>e.jsxs("li",{children:["â€¢ ",t]},r))})]}),e.jsx("button",{onClick:l,className:"w-full p-6 bg-cyan-600 text-white font-bold rounded-3xl shadow-lg shadow-cyan-900/20 transition-transform active:scale-95 text-lg",children:"Start Quiz"})]})]}),"undefined"!=typeof document&&p.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>q(e=>!e),className:"fixed top-20 right-8 z-[260] p-3 rounded-2xl backdrop-blur-xl border shadow-2xl transition-all active:scale-95 "+(X?"bg-blue-600 text-white border-blue-500/40 shadow-blue-900/30":"bg-white/90 dark:bg-slate-800/90 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-white/10 hover:text-cyan-600 dark:hover:text-white"),title:X?"Exit Study Mode":"Study Mode","aria-pressed":X,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx(C,{fontSize:Q,setFontSize:G}),X&&e.jsx("div",{className:"fixed top-52 right-8 z-[255] pointer-events-auto",children:e.jsx(z,{currentTool:K,setTool:V,onUndo:Se,onClear:Me,canUndo:Ee,currentColor:te,onColorChange:re,highlightMode:se,onHighlightModeChange:ne})}),j&&e.jsxs("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-[90] flex items-center gap-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur-xl p-4 rounded-full border shadow-2xl animate-in slide-in-from-bottom-10",children:[e.jsx("button",{onClick:()=>{I([]),localStorage.removeItem(Ne)},className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg mr-2",title:"Clear all study marks",children:"Clear"}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("button",{onClick:()=>I(e=>e.slice(0,-1)),disabled:0===D.length,className:"p-2 font-bold "+(0===D.length?"text-slate-300 dark:text-slate-700":"text-slate-500 hover:text-slate-900 dark:hover:text-white"),children:"Undo"}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700"}),e.jsxs("button",{onClick:()=>E("pen"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("pen"===M?"bg-blue-500 text-white shadow-lg shadow-blue-500/30":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 shadow-sm "+("pen"===M?"ring-2 ring-white":"")}),e.jsx("span",{className:"font-bold text-sm",children:"Pen"})]}),e.jsxs("button",{onClick:()=>E("highlighter"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("highlighter"===M?"bg-slate-100 dark:bg-white/10 ring-2 ring-blue-500":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx("div",{onClick:e=>{e.stopPropagation(),O("yellow"),E("highlighter")},className:"w-4 h-4 rounded-full bg-yellow-400 border border-yellow-600/20 "+("yellow"===F?"ring-2 ring-blue-500 ring-offset-2":""),title:"Yellow Highlight"}),e.jsx("div",{onClick:e=>{e.stopPropagation(),O("red"),E("highlighter")},className:"w-4 h-4 rounded-full bg-red-500 border border-red-600/20 "+("red"===F?"ring-2 ring-blue-500 ring-offset-2":""),title:"Red Text Highlight"}),e.jsx("span",{className:"font-bold text-sm ml-1",children:"Highlighter"})]}),e.jsxs("button",{onClick:()=>E("eraser"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("eraser"===M?"bg-slate-800 text-white shadow-lg":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx(d,{size:16,strokeWidth:2,className:"transition-transform "+("eraser"===M?"scale-125":"scale-100")}),e.jsx("span",{className:"font-bold text-sm",children:"Eraser"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 font-black text-blue-500 hover:text-blue-600",children:"Close"})]})]}),document.body),k&&e.jsx(y,{src:k,onClose:()=>w(null)})]}):e.jsx("div",{children:"Error loading content"});var De};export{F as default};
