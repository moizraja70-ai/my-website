import{a as o,j as e}from"./index-DRDHy3_1.js";import{a as M}from"./geminiService-DYgmlQ0M.js";const Q=({subject:i,stream:k,onClose:c,onUpdateStats:j,stats:d={correct:0,incorrect:0}})=>{const[t,w]=o.useState(null),[y,u]=o.useState(!0),[l,g]=o.useState(null),[r,f]=o.useState(!1),p=async()=>{u(!0),g(null),f(!1);try{const s=await M(i,1,k,void 0,"Challenge");s.length>0&&w(s[0])}catch(s){console.error("Failed to load MCQ",s)}finally{u(!1)}};o.useEffect(()=>{p()},[]);const v=()=>{if(l===null||!t)return;f(!0);const s=l===t.correctAnswerIndex;j(i,s)},N=()=>{p()};if(y)return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 animate-in fade-in duration-300",children:e.jsx("div",{className:"glass-panel p-8 rounded-3xl max-w-2xl w-full mx-4 bg-white/90 dark:bg-slate-800/90",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Loading quick quiz..."})]})})});if(!t)return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 animate-in fade-in duration-300",children:e.jsx("div",{className:"glass-panel p-8 rounded-3xl max-w-2xl w-full mx-4 bg-white/90 dark:bg-slate-800/90",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"No questions available"}),e.jsx("button",{onClick:c,className:"px-6 py-2 bg-cyan-600 text-white rounded-xl hover:bg-cyan-500",children:"Close"})]})})});const x=l===t.correctAnswerIndex,m=d.correct+d.incorrect,C=m>0?Math.round(d.correct/m*100):0;return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 animate-in fade-in duration-300 p-4",children:e.jsxs("div",{className:"glass-panel p-8 rounded-3xl max-w-3xl w-full bg-white/90 dark:bg-slate-800/90 max-h-[90vh] overflow-y-auto animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:["ðŸŽ¯ Quick Quiz: ",i]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 dark:bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 rounded-full font-bold flex items-center gap-1",children:[e.jsx("span",{className:"text-yellow-500",children:"âš¡"})," Challenge Mode"]}),e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Accuracy: ",e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:[C,"%"]})," (",d.correct,"/",m,")"]})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-white leading-relaxed",children:t.question})}),e.jsx("div",{className:"space-y-3 mb-6",children:t.options.map((s,a)=>{const h=a===t.correctAnswerIndex,b=l===a;let n="border-slate-200 dark:border-white/10 hover:border-cyan-300 dark:hover:border-cyan-500/30";return r?h?n="border-green-500 bg-green-50 dark:bg-green-900/20 ring-2 ring-green-500":b?n="border-red-500 bg-red-50 dark:bg-red-900/20 ring-2 ring-red-500":n="border-slate-200 dark:border-white/10 opacity-50":b&&(n="border-cyan-500 bg-cyan-50 dark:bg-cyan-900/20 ring-2 ring-cyan-500"),e.jsx("button",{onClick:()=>!r&&g(a),disabled:r,className:`w-full text-left p-4 rounded-xl border-2 transition-all ${n} ${r?"cursor-default":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-8 h-8 flex items-center justify-center rounded-lg text-sm font-bold ${r&&h?"bg-green-500 text-white":b?"bg-cyan-600 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300"}`,children:String.fromCharCode(65+a)}),e.jsx("span",{className:"text-slate-900 dark:text-white",children:s}),r&&h&&e.jsx("svg",{className:"w-5 h-5 text-green-500 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})},a)})}),r&&e.jsxs("div",{className:`p-4 rounded-xl mb-6 ${x?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-500/30":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-500/30"}`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:`font-bold ${x?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:x?"âœ“ Correct!":"âœ— Incorrect"})}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.explanation})]}),e.jsx("div",{className:"flex gap-3",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,className:"flex-1 py-3 rounded-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-500 hover:to-pink-500 shadow-lg flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Roll Another"]}),e.jsx("button",{onClick:c,className:"px-6 py-3 rounded-xl font-bold bg-slate-200 dark:bg-slate-700 text-slate-900 dark:text-white hover:bg-slate-300 dark:hover:bg-slate-600",children:"Done"})]}):e.jsx("button",{onClick:v,disabled:l===null,className:`flex-1 py-3 rounded-xl font-bold transition-all ${l===null?"bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-not-allowed":"bg-cyan-600 text-white hover:bg-cyan-500 shadow-lg"}`,children:"Check Answer"})})]})})};export{Q as default};
