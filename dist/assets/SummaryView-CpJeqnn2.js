import{j as e,R as t,a as r,k as s,l as n,m as o,n as l,o as a,p as i,q as c,D as d,s as h,t as u,i as x}from"./vendor-react-CR1W5LLW.js";import{r as g}from"./vendor-react-dom-CF6xyiui.js";import{M as m}from"./content-gic-DjMOnmO8.js";import{f as b,M as p}from"./index-CXIIGIu2.js";import{q as f,w as v}from"./vendor-BoCg3Acf.js";import"./content-impression-Dhon-y05.js";import"./content-gypsum-CDET_BPX.js";import"./content-composite-BRuCwDEI.js";import"./content-adhesion-CpUmy9Us.js";import"./content-wax-dj-jQmTY.js";import"./content-metals-MuXxPaYj.js";import"./content-investment-CeySKURn.js";import"./content-casting-DyIojzrT.js";import"./content-cements-ndFgpqB6.js";import"./content-amalgam-ZoqsmOFz.js";import"./content-ceramics-CC7zDBK1.js";import"./content-properties-Bpg7iEuo.js";import"./content-denture-8EmkrB6b.js";import"./content-embryology-tavoNC7p.js";import"./content-osteology-3u2sacyF.js";import"./vendor-markdown-qiocwJQ_.js";const k=({src:t,alt:r,onClose:s})=>e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-in fade-in duration-300",onClick:s,children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 text-white/70 hover:text-white bg-white/10 hover:bg-white/20 rounded-full transition-colors z-[101]",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"relative max-w-full max-h-full",onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:t,alt:r||"Expanded view",className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl"}),r&&e.jsx("p",{className:"absolute bottom-[-3rem] left-0 right-0 text-center text-white/90 text-sm font-medium",children:r})]})]}),w=t.memo(({tool:t,active:s,strokes:n,onStrokeComplete:o,onEraseStroke:l,onStrokesUpdate:a,color:i="#ef4444",strokeWidth:c=3,eraserSize:d=30,isDarkMode:h=!1,highlightBlendMode:u})=>{const x=r.useRef(null),g=r.useRef(null),m=r.useRef(null),b=r.useRef(!1),p=r.useRef(!1),f=r.useRef([]),v=r.useRef(null),k=r.useRef([]),w=r.useRef(null),j=r.useRef(null),y=r.useRef(null),C=r.useRef(new Map),N=100,S="undefined"!=typeof window?Math.min(window.devicePixelRatio||1,2):1,M=(e,t)=>{if(e.startsWith("#")){const r=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return{r:r,g:s,b:n,rgba:`rgba(${r}, ${s}, ${n}, ${t})`}}const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(r){const e=Number(r[1]),s=Number(r[2]),n=Number(r[3]);return{r:e,g:s,b:n,rgba:`rgba(${e}, ${s}, ${n}, ${t})`}}return{r:255,g:212,b:0,rgba:`rgba(255, 212, 0, ${t})`}};r.useEffect(()=>{k.current=(n||[]).filter(e=>null!=e),$(),E()},[n]);const $=()=>{C.current.clear(),k.current.forEach((e,t)=>{if(!e)return;let r=e.bbox;if(!r&&e.points&&e.points.length>0){let t=1/0,s=1/0,n=-1/0,o=-1/0;for(const r of e.points)r.x<t&&(t=r.x),r.x>n&&(n=r.x),r.y<s&&(s=r.y),r.y>o&&(o=r.y);r={minX:t,minY:s,maxX:n,maxY:o},e.bbox=r}if(!r)return;const s=Math.floor(r.minX/N),n=Math.floor(r.minY/N),o=Math.floor(r.maxX/N),l=Math.floor(r.maxY/N);for(let a=s;a<=o;a++)for(let e=n;e<=l;e++){const r=`${a},${e}`;C.current.has(r)||C.current.set(r,new Set),C.current.get(r).add(t)}})},D=(e,t)=>{if(!t||!t.points||t.points.length<1)return;const r=t.points;if("rect-highlight"===t.tool){const s=t.color&&(t.color.includes("239")||t.color.includes("68")||t.color.includes("red")),n=t.color||(s?"#FF3B3B":"#FFD400"),{r:o,g:l,b:a}=M(n,1),i=h?.28:.14,c=h?.4:.2;e.globalCompositeOperation=h?"screen":"multiply",e.fillStyle=`rgba(${o}, ${l}, ${a}, ${i})`,e.shadowBlur=8,e.shadowColor=`rgba(${o}, ${l}, ${a}, 0.55)`;for(let t=0;t<r.length;t+=2)r[t+1]&&e.fillRect(r[t].x,r[t].y,r[t+1].x,r[t+1].y);e.globalCompositeOperation="screen",e.fillStyle=`rgba(${o}, ${l}, ${a}, ${c})`;for(let t=0;t<r.length;t+=2)r[t+1]&&e.fillRect(r[t].x,r[t].y,r[t+1].x,r[t+1].y);return e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}if(e.beginPath(),e.lineCap="round",e.lineJoin="round","pen"===t.tool)e.strokeStyle=t.color||"#ef4444",e.lineWidth=t.width||3,e.globalCompositeOperation="source-over";else if("highlighter"===t.tool){const r=t.color&&(t.color.includes("red")||t.color.includes("255, 60")),s=t.color||(r?"#FF3B3B":"#FFD400"),n=h?.32:.12,{r:o,g:l,b:a}=M(s,1);e.strokeStyle=`rgba(${o}, ${l}, ${a}, ${n})`,e.lineWidth=Math.max(t.width||12,9),e.lineCap="round",e.globalCompositeOperation=h?"screen":"multiply",e.shadowBlur=10,e.shadowColor=`rgba(${o}, ${l}, ${a}, 0.6)`}else"eraser"===t.tool&&(e.strokeStyle="white",e.lineWidth=t.width||30,e.globalCompositeOperation="destination-out");if(1===r.length){const t=r[0],s=Math.max((e.lineWidth||3)/2,1);return e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fillStyle=e.strokeStyle,e.fill(),e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}e.moveTo(r[0].x,r[0].y);for(let s=1;s<r.length-1;s++){const t=r[s],n=r[s+1],o={x:(t.x+n.x)/2,y:(t.y+n.y)/2};e.quadraticCurveTo(t.x,t.y,o.x,o.y)}e.lineTo(r[r.length-1].x,r[r.length-1].y),e.stroke(),e.shadowBlur=0,e.shadowColor="transparent",e.globalCompositeOperation="source-over"},E=r.useCallback(()=>{const e=x.current;if(!e)return;const t=e.getContext("2d",{alpha:!0});t&&(t.clearRect(0,0,e.width/S,e.height/S),k.current.forEach(e=>D(t,e)))},[S]),z=r.useCallback(()=>{const e=g.current;if(!e)return;const r=e.getContext("2d");r&&(r.clearRect(0,0,e.width/S,e.height/S),R.current&&(E(),R.current=!1),b.current&&("pen"===t||"highlighter"===t)&&f.current.length>0&&D(r,{tool:t,points:f.current,color:i,width:c}))},[S,t,i,c]);r.useEffect(()=>{const e=m.current,t=x.current,r=g.current;if(!e||!t||!r)return;const s=new ResizeObserver(e=>{for(const s of e){const{width:e,height:n}=s.contentRect;[t,r].forEach(t=>{t.width=e*S,t.height=n*S,t.style.width=`${e}px`,t.style.height=`${n}px`;const r=t.getContext("2d");r&&r.setTransform(S,0,0,S,0,0)}),E()}});return e.parentElement&&s.observe(e.parentElement),()=>s.disconnect()},[S,E]),r.useEffect(()=>{s&&E(),s||(b.current=!1,p.current=!1,f.current=[],v.current=null,j.current=null,y.current=null,w.current=null)},[s,n,E]);const P=e=>{const t=g.current;if(!t)return null;const r=t.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top}},R=r.useRef(!1),L=(e,t)=>{const r=((e,t)=>{const r=d/2+5,s=r*r,n=Math.floor(e/N),o=Math.floor(t/N),l=new Set;for(let i=-1;i<=1;i++)for(let e=-1;e<=1;e++){const t=C.current.get(`${n+i},${o+e}`);t&&t.forEach(e=>l.add(e))}const a=Array.from(l).sort((e,t)=>t-e);for(const i of a){const n=k.current[i];if(n&&n.points)if("rect-highlight"===n.tool)for(let r=0;r<n.points.length;r+=2){if(!n.points[r+1])continue;const o=n.points[r].x,l=n.points[r].y,a=n.points[r+1].x,c=n.points[r+1].y,d=e-Math.max(o,Math.min(e,o+a)),h=t-Math.max(l,Math.min(t,l+c));if(d*d+h*h<s)return i}else{const s=r+(n.width||3)/2,o=s*s;for(const r of n.points){const s=e-r.x,n=t-r.y;if(s*s+n*n<o)return i}}}return-1})(e,t);-1!==r&&(k.current=k.current.filter((e,t)=>t!==r),$(),R.current=!0,p.current=!0,l&&!a&&l(r))},B=e=>{if(b.current){try{e.target.releasePointerCapture(e.pointerId)}catch{}if(b.current=!1,f.current.length>0&&("pen"===t||"highlighter"===t)){const e=[...f.current];let r=1/0,s=1/0,n=-1/0,l=-1/0;for(const t of e)t.x<r&&(r=t.x),t.x>n&&(n=t.x),t.y<s&&(s=t.y),t.y>l&&(l=t.y);o({tool:t,points:e,color:i,width:c,bbox:{minX:r,minY:s,maxX:n,maxY:l}})}p.current&&a&&(a([...k.current]),p.current=!1),f.current=[],v.current=null,j.current=null,y.current=null,z()}};return e.jsxs("div",{ref:m,className:"absolute inset-0 z-20 pointer-events-none transition-opacity duration-300 "+(s?"opacity-100":"opacity-0"),children:[e.jsx("canvas",{ref:x,className:"absolute inset-0 touch-none pointer-events-none",style:{mixBlendMode:"highlighter"===t?u||(h?"screen":"multiply"):h?"multiply":"screen"}}),e.jsx("canvas",{ref:g,className:"absolute inset-0 touch-none "+(!s||"pen"!==t&&"eraser"!==t?"pointer-events-none":"pointer-events-auto"),style:{cursor:"eraser"===t?'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%20stroke%3D%22black%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M2%2016l9-9a2%202%200%200%201%203%200l6%206a2%202%200%200%201%200%203l-6%206H7l-5-5z%22/%3E%3Cpath%20d%3D%22M8%2021l6-6%22/%3E%3C/svg%3E") 12 12, auto':"crosshair",mixBlendMode:"highlighter"===t?u||(h?"screen":"multiply"):h?"multiply":"screen"},onPointerDown:e=>{if(!s)return;e.target.setPointerCapture(e.pointerId),b.current=!0;const r=P(e);r&&(w.current=r,f.current=[r],v.current=r,"highlighter"===t&&(j.current=null,y.current=r),"eraser"===t&&L(r.x,r.y),z())},onPointerMove:e=>{if(!s)return;const r=e.getCoalescedEvents?e.getCoalescedEvents():[e];let n=!1;for(const s of r){const e=P(s);if(e&&(w.current=e,b.current))if("eraser"===t)L(e.x,e.y),n=!0;else if("pen"===t||"highlighter"===t){let r=e;if("highlighter"===t&&y.current){if(!j.current){const t=Math.abs(e.x-y.current.x),r=Math.abs(e.y-y.current.y);(t>3||r>3)&&(j.current=t>=r?"horizontal":"vertical")}"horizontal"===j.current?r={x:e.x,y:y.current.y}:"vertical"===j.current&&(r={x:y.current.x,y:e.y})}(v.current?Math.pow(r.x-v.current.x,2)+Math.pow(r.y-v.current.y,2):100)>4&&(f.current.push(r),v.current=r,n=!0)}}n&&z()},onPointerUp:B,onPointerLeave:B,onPointerCancel:B})]})}),j=({fontSize:t,setFontSize:l,min:a=14,max:i=32})=>{const[c,d]=r.useState(!1),h=r.useRef(null);return r.useEffect(()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&d(!1)};return c&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[c]),e.jsxs("div",{ref:h,className:"fixed top-36 right-8 z-[100] isolate",children:[e.jsx("style",{children:"\n        .t-fab-shadow { box-shadow: 0 18px 50px rgba(0,0,0,0.55); }\n        .slider-bar-shadow { box-shadow: 0 18px 50px rgba(0,0,0,0.55); }\n        .gradient-chip { background: linear-gradient(180deg, #111a2a, #0f1726); }\n      "}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!0),className:`\n            w-[54px] h-[54px] rounded-full border border-white/15 text-white/90 \n            grid place-items-center cursor-pointer t-fab-shadow gradient-chip\n            transition-all duration-300 ease-out\n            ${c?"opacity-0 scale-90 pointer-events-none translate-y-[-6px]":"opacity-100 scale-100 translate-y-0"}\n          `,"aria-label":"Open text size control",children:e.jsx("span",{className:"font-bold text-lg tracking-wide",children:"T"})}),e.jsxs("div",{className:`\n            absolute top-0 right-0\n            h-[54px] rounded-full border border-white/15 \n            flex items-center gap-3 px-4 overflow-hidden slider-bar-shadow gradient-chip\n            transition-all duration-300 ease-out origin-right\n            ${c?"w-[320px] opacity-100 scale-100 translate-y-0 pointer-events-auto":"w-[54px] opacity-0 scale-90 translate-y-[-6px] pointer-events-none"}\n          `,children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),l(Math.max(a,t-2))},className:"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10 text-white/90 hover:bg-white/10 active:scale-95 transition-all flex-shrink-0",children:e.jsx(s,{size:16})}),e.jsx("input",{type:"range",min:a,max:i,value:t,onChange:e=>l(Number(e.target.value)),className:"flex-1 h-1.5 bg-white/15 rounded-full appearance-none cursor-pointer accent-blue-500"}),e.jsx("button",{onClick:e=>{e.stopPropagation(),l(Math.min(i,t+2))},className:"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10 text-white/90 hover:bg-white/10 active:scale-95 transition-all flex-shrink-0",children:e.jsx(n,{size:16})}),e.jsxs("div",{className:"flex items-center gap-1 text-white/90 flex-shrink-0 pl-1",children:[e.jsx(o,{size:18}),e.jsx("div",{className:"w-px h-4 bg-white/15 mx-2"}),e.jsxs("span",{className:"text-xs font-mono text-white/65 tabular-nums w-8 text-right",children:[t,"px"]})]})]})]})]})},y=(e,t,r=!1)=>{if(t.points.length<1)return;const{points:s,tool:n,color:o,size:l}=t;if(e.lineWidth=l,e.lineCap="round",e.lineJoin="round","eraser"===n)e.globalCompositeOperation="destination-out",e.strokeStyle="rgba(0,0,0,1)";else if("highlighter"===n){e.globalCompositeOperation=r?"screen":"multiply";const t=r?.32:.12,{r:s,g:n,b:l}=((e,t)=>{if(e.startsWith("#")){const r=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return{r:r,g:s,b:n,rgba:`rgba(${r}, ${s}, ${n}, ${t})`}}const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(r){const e=Number(r[1]),s=Number(r[2]),n=Number(r[3]);return{r:e,g:s,b:n,rgba:`rgba(${e}, ${s}, ${n}, ${t})`}}return{r:255,g:212,b:0,rgba:`rgba(255, 212, 0, ${t})`}})(o,1);e.strokeStyle=`rgba(${s}, ${n}, ${l}, ${t})`,e.shadowBlur=10,e.shadowColor=`rgba(${s}, ${n}, ${l}, 0.6)`}else e.globalCompositeOperation="source-over",e.strokeStyle=o;if(1===t.points.length){const t=s[0],r=Math.max(l/2,1);return e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fillStyle="eraser"===n?"rgba(0,0,0,1)":"highlighter"===n?e.strokeStyle:o,e.fill(),e.shadowBlur=0,e.shadowColor="transparent",void(e.globalCompositeOperation="source-over")}e.beginPath(),e.moveTo(s[0].x,s[0].y);for(let i=1;i<s.length-1;i++){const t=s[i],r=s[i+1],n={x:(t.x+r.x)/2,y:(t.y+r.y)/2};e.quadraticCurveTo(t.x,t.y,n.x,n.y)}const a=s[s.length-1];e.lineTo(a.x,a.y),e.stroke(),e.shadowBlur=0,e.shadowColor="transparent",e.globalCompositeOperation="source-over"},C=(e,t)=>{const r=t.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top,pressure:e.pressure}},N=({currentTool:t,strokes:s,setStrokes:n,currentColor:o="#FCD34D",isDarkMode:l=!1})=>{const a=r.useRef(null),i=r.useRef(null),c=r.useRef(null),d=r.useRef(!1),h=r.useRef(null),u=r.useRef(s),x=r.useRef(null),g=r.useRef(null),m=r.useRef(null),b={select:{color:o,size:0},pen:{color:o,size:3},highlighter:{color:o,size:14},eraser:{color:"rgb(0,0,0)",size:30}},p=r.useCallback(()=>{if(!a.current)return;const e=a.current.getContext("2d");e&&(e.clearRect(0,0,a.current.width,a.current.height),u.current.forEach(t=>{y(e,t,l)}))},[l]),f=r.useCallback(()=>{if(!i.current)return;const e=i.current.getContext("2d");e&&e.clearRect(0,0,i.current.width,i.current.height)},[l]);r.useEffect(()=>{const e=()=>{if(!a.current||!i.current||!c.current)return;const e=c.current,t="undefined"!=typeof window?Math.min(window.devicePixelRatio||1,2):1;[a.current,i.current].forEach(r=>{r.width=e.clientWidth*t,r.height=e.clientHeight*t,r.style.width=`${e.clientWidth}px`,r.style.height=`${e.clientHeight}px`;const s=r.getContext("2d");s&&s.setTransform(t,0,0,t,0,0)}),p(),f()};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[p,f]),r.useEffect(()=>{u.current=s,p(),f()},[s,p,f]);const v=e=>{if(!d.current)return;i.current&&i.current.releasePointerCapture(e.pointerId),d.current=!1;const t=h.current;if(t){const e=[...u.current,t];u.current=e,n(e)}h.current=null,x.current=null,g.current=null,m.current=null,p(),f()};return e.jsxs("div",{ref:c,className:"absolute inset-0 w-full h-full",style:{cursor:"select"===t?"default":"eraser"===t?'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22white%22%20stroke%3D%22black%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M2%2016l9-9a2%202%200%200%201%203%200l6%206a2%202%200%200%201%200%203l-6%206H7l-5-5z%22/%3E%3Cpath%20d%3D%22M8%2021l6-6%22/%3E%3C/svg%3E") 12 12, auto':"crosshair"},children:[e.jsx("canvas",{ref:a,className:"absolute inset-0 block pointer-events-none"}),e.jsx("canvas",{ref:i,className:"absolute inset-0 block touch-none",onPointerDown:e=>{var r,s;if(!i.current)return;if("select"===t)return;i.current.setPointerCapture(e.pointerId);const n=C(e,i.current),o=b[t];d.current=!0,h.current={points:[n],tool:t,color:o.color,size:o.size},x.current=n,"highlighter"===t&&(g.current=null,m.current=n);const c="eraser"===t?null==(r=a.current)?void 0:r.getContext("2d"):null==(s=i.current)?void 0:s.getContext("2d");c&&y(c,h.current,l)},onPointerMove:e=>{var r,s;if(!d.current||!i.current||"select"===t)return;const n=e.getCoalescedEvents?e.getCoalescedEvents():[e],o=h.current;if(o)for(const c of n){const e=C(c,i.current);let n=e;if("highlighter"===t&&m.current){if(!g.current){const t=Math.abs(e.x-m.current.x),r=Math.abs(e.y-m.current.y);(t>3||r>3)&&(g.current=t>=r?"horizontal":"vertical")}"horizontal"===g.current?n={x:e.x,y:m.current.y}:"vertical"===g.current&&(n={x:m.current.x,y:e.y})}const d=x.current;if(d){const e=n.x-d.x,t=n.y-d.y;if(e*e+t*t<4)continue}o.points.push(n);const h="eraser"===t?null==(r=a.current)?void 0:r.getContext("2d"):null==(s=i.current)?void 0:s.getContext("2d");h&&d&&y(h,{...o,points:[d,n]},l),x.current=n}},onPointerUp:v,onPointerLeave:v})]})},S=({isActive:t,currentTool:r,highlightMode:s="freehand",strokes:n,setStrokes:o,currentColor:l,isDarkMode:a=!1})=>t?e.jsx("div",{className:"absolute inset-0 z-[200] pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 "+("select"===r||"highlighter"===r&&"text"===s?"pointer-events-none":"pointer-events-auto"),children:e.jsx(N,{currentTool:r,strokes:n,setStrokes:o,currentColor:l,isDarkMode:a})})}):null,M=[{name:"Yellow",value:"#FCD34D",bg:"bg-yellow-400"},{name:"Mint",value:"#6EE7B7",bg:"bg-emerald-300"},{name:"Red",value:"#EF4444",bg:"bg-red-500"},{name:"White",value:"#FFFFFF",bg:"bg-white",className:"border border-slate-300"},{name:"Black",value:"#111827",bg:"bg-slate-900"}],$=({currentTool:t,setTool:n,onUndo:x,onClear:g,canUndo:m,onClose:b,currentColor:p="#FCD34D",onColorChange:f,highlightMode:v="freehand",onHighlightModeChange:k})=>{const[w,j]=r.useState(!1),y="eraser"===t,C=e=>t=>{t.preventDefault(),n(e)},N=e=>t=>{t.preventDefault(),null==k||k(e)};return w?e.jsx("button",{onPointerDown:e=>{e.preventDefault(),j(!1)},onClick:()=>j(!1),className:"w-12 h-12 rounded-full bg-white/95 dark:bg-slate-900/95 border border-slate-200 dark:border-slate-700 shadow-xl backdrop-blur-xl flex items-center justify-center text-slate-700 dark:text-slate-200 hover:scale-105 transition-transform",title:"Open toolbar",children:e.jsx(l,{size:18,strokeWidth:2})}):e.jsxs("div",{className:"flex items-center gap-2 bg-white/95 dark:bg-slate-900/95 border border-slate-200 dark:border-slate-700 rounded-2xl px-4 py-2 shadow-xl backdrop-blur-xl touch-manipulation",children:[e.jsx("button",{onPointerDown:e=>{e.preventDefault(),j(!0)},onClick:()=>j(!0),className:"p-2 rounded-full transition-all text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800",title:"Collapse toolbar",children:e.jsx(a,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:C("select"),onClick:()=>n("select"),className:"p-2 rounded-full transition-all "+("select"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Select",children:e.jsx(i,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:C("pen"),onClick:()=>n("pen"),className:"p-2 rounded-full transition-all "+("pen"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Pen",children:e.jsx(l,{size:18,strokeWidth:2})}),e.jsx("button",{onPointerDown:C("eraser"),onClick:()=>n("eraser"),className:"p-2 rounded-full transition-all "+("eraser"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Eraser",children:e.jsx(c,{size:18,strokeWidth:2,className:"transition-transform "+(y?"scale-125":"scale-100")})}),e.jsx("button",{onPointerDown:C("highlighter"),onClick:()=>n("highlighter"),className:"p-2 rounded-full transition-all "+("highlighter"===t?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Highlighter",children:e.jsx(s,{size:18,strokeWidth:3})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),"highlighter"===t&&k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onPointerDown:N("text"),onClick:()=>k("text"),className:"p-2 rounded-full transition-all "+("text"===v?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Text highlight",children:e.jsx(o,{size:16,strokeWidth:2})}),e.jsx("button",{onPointerDown:N("freehand"),onClick:()=>k("freehand"),className:"p-2 rounded-full transition-all "+("freehand"===v?"bg-slate-900 dark:bg-slate-700 text-white shadow-md":"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Freehand highlight",children:e.jsx(l,{size:16,strokeWidth:2})})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:M.map(t=>{return e.jsx("button",{onPointerDown:(r=t.value,e=>{e.preventDefault(),null==f||f(r)}),onClick:()=>null==f?void 0:f(t.value),className:`w-7 h-7 rounded-full transition-all hover:scale-110 ${t.bg} ${t.className||""} ${p===t.value?"ring-2 ring-blue-500 ring-offset-2 ring-offset-white dark:ring-offset-slate-900":"hover:ring-2 hover:ring-slate-300 dark:hover:ring-slate-600"}`,title:t.name},t.value);var r})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("div",{className:"p-2 rounded-full text-slate-500 dark:text-slate-400",children:e.jsx(d,{size:18,strokeWidth:2})}),e.jsx("button",{onClick:x,disabled:!m,className:"p-2 rounded-full transition-all "+(m?"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800":"text-slate-300 dark:text-slate-700 cursor-not-allowed"),title:"Undo",children:e.jsx(h,{size:18,strokeWidth:2})}),e.jsx("button",{onClick:g,className:"p-2 rounded-full transition-all text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800",title:"Clear All",children:e.jsx(u,{size:18,strokeWidth:2})})]})},D=({onInsert:t,onSave:s,onCancel:n})=>{const o=r.useRef(null);return e.jsxs("div",{className:"sticky top-4 z-50 mb-6 bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-white/10 p-3 flex flex-wrap items-center gap-2 animate-in slide-in-from-top-4",children:[e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("**","**"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold",title:"Bold",children:"B"}),e.jsx("button",{onClick:()=>t("*","*"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 italic",title:"Italic",children:"I"}),e.jsx("button",{onClick:()=>t('<span style="color: red">',"</span>"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-red-500 font-bold",title:"Red Text",children:"A"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("# "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-lg",title:"Heading 1",children:"H1"}),e.jsx("button",{onClick:()=>t("## "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-base",title:"Heading 2",children:"H2"}),e.jsx("button",{onClick:()=>t("### "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 font-bold text-sm",title:"Heading 3",children:"H3"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("button",{onClick:()=>t("- "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Bullet List",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("button",{onClick:()=>t("1. "),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Numbered List",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h12M7 12h12M7 17h12M3 7h1m-1 5h1m-1 5h1"})})})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-slate-200 dark:border-white/10 pr-2 mr-1",children:[e.jsx("input",{ref:o,type:"file",accept:"image/*",onChange:e=>{var r;const s=null==(r=e.target.files)?void 0:r[0];if(!s)return;const n=new FileReader;n.onload=e=>{var r;const n=null==(r=e.target)?void 0:r.result,o=`![${s.name}](${n})`;t(o)},n.readAsDataURL(s),o.current&&(o.current.value="")},className:"hidden"}),e.jsx("button",{onClick:()=>{var e;return null==(e=o.current)?void 0:e.click()},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300",title:"Upload Image",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:s,className:"px-6 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-bold shadow-lg shadow-emerald-500/20 transition-all hover:scale-105",children:"Save Changes"})]})]})},E={},z=e=>{if(!e)return{r:255,g:212,b:0};if(e.startsWith("#")&&e.length>=7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)};const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);return t?{r:Number(t[1]),g:Number(t[2]),b:Number(t[3])}:{r:255,g:212,b:0}},P=(()=>{try{return new RegExp("(?<=a)b"),new RegExp("\\p{P}","u"),!0}catch{return!1}})(),R=t.memo(({content:t,setSelectedImage:r,isGIC:s})=>e.jsx(x,{remarkPlugins:P?[v]:[],rehypePlugins:[f],components:{img:({node:t,...s})=>e.jsxs("div",{className:"my-10 relative group select-none",children:[e.jsx("div",{className:"absolute inset-0 z-40 bg-transparent",onContextMenu:e=>e.preventDefault()}),s.src&&s.src.includes("impression_downloadable_summary.png")&&e.jsxs("a",{href:s.src,download:"Impression_Materials_Summary.png",onClick:e=>e.stopPropagation(),className:"absolute top-4 right-4 bg-white/90 dark:bg-slate-800/90 text-slate-900 dark:text-white px-4 py-2 rounded-lg font-bold shadow-lg z-[60] hover:bg-white dark:hover:bg-slate-700 transition-colors flex items-center gap-2 pointer-events-auto cursor-pointer border border-slate-200 dark:border-white/10",title:"Download Summary Table",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]}),e.jsx("img",{...s,onClick:()=>s.src&&r(s.src),className:"rounded-2xl shadow-xl border border-slate-200 dark:border-white/10 w-full max-w-[800px] mx-auto object-contain transition-transform hover:scale-[1.01] duration-500 cursor-zoom-in relative z-30 select-none pointer-events-auto bg-white",draggable:!1,alt:s.alt||"Medical Diagram",style:{display:"block"}}),s.alt&&e.jsx("p",{className:"text-center text-base text-slate-500 dark:text-slate-400 mt-4 font-sans font-medium",children:s.alt})]}),table:({node:t,...r})=>e.jsx("div",{className:"overflow-x-auto my-6 border border-slate-300 dark:border-slate-600 rounded-lg",children:e.jsx("table",{...r,className:"min-w-full text-left border-collapse bg-white dark:bg-slate-900"})}),thead:({node:t,...r})=>e.jsx("thead",{...r,className:"bg-slate-100 dark:bg-slate-800"}),th:({node:t,...r})=>e.jsx("th",{...r,className:"px-6 py-4 border border-slate-300 dark:border-slate-600 font-bold text-slate-900 dark:text-white bg-slate-100 dark:bg-slate-800 text-sm md:text-base align-top"}),td:({node:t,...r})=>e.jsx("td",{...r,className:"px-6 py-4 border border-slate-300 dark:border-slate-600 text-slate-800 dark:text-slate-200 align-top "+(s?"text-lg md:text-xl":"text-sm md:text-base")}),h1:({node:t,...r})=>e.jsx("h1",{...r,className:"medical-serif text-3xl md:text-4xl font-black mb-8 text-slate-900 dark:text-white tracking-tight"}),h2:({node:t,...r})=>e.jsxs("div",{className:"mt-16 mb-8 pt-8 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-slate-300 dark:via-white/20 to-transparent"}),e.jsx("h2",{...r,className:"medical-serif text-2xl md:text-3xl font-bold text-slate-900 dark:text-white"})]}),h3:({node:t,...r})=>e.jsx("h3",{...r,className:"medical-serif text-xl md:text-2xl font-bold mt-10 mb-5 text-slate-800 dark:text-slate-200"}),ol:({node:t,...r})=>e.jsx("ol",{...r,className:"space-y-3 my-6 list-decimal pl-8"}),ul:({node:t,...r})=>e.jsx("ul",{...r,className:"space-y-3 my-6 list-disc pl-8 marker:text-slate-500"}),strong:({node:t,...r})=>e.jsx("strong",{...r,className:"font-bold text-slate-900 dark:text-white"}),hr:({node:t,...r})=>e.jsx("div",{className:"my-14 h-px bg-gradient-to-r from-transparent via-slate-300 dark:via-white/20 to-transparent"}),iframe:({node:t,...r})=>e.jsx("div",{className:"my-10 relative w-full aspect-video rounded-2xl overflow-hidden shadow-xl border border-slate-200 dark:border-white/10",children:e.jsx("iframe",{...r,className:"absolute inset-0 w-full h-full"})}),video:({node:t,...r})=>e.jsx("div",{className:"my-10 relative w-full rounded-2xl overflow-hidden shadow-xl border border-slate-200 dark:border-white/10",children:e.jsx("video",{...r,className:"w-full",controls:!0})}),p:({node:t,...r})=>e.jsx("div",{...r,className:s?"text-lg md:text-xl leading-relaxed mb-6":"mb-4"}),li:({node:t,...r})=>e.jsx("li",{...r,className:s?"text-lg md:text-xl leading-relaxed mb-3":"mb-2"}),a:p},children:t}),(e,t)=>e.content===t.content&&e.isGIC===t.isGIC),L=({subject:t,topic:s,stream:n,onStartQuiz:o,onBack:l,isDarkMode:a,onPageContentChange:i,isAdmin:d})=>{const[h,u]=r.useState(null),[x,p]=r.useState(!0),[f,v]=r.useState(!1),[y,C]=r.useState(null),[N,M]=r.useState(!1),[P,L]=r.useState("pen"),[B,I]=r.useState([]),[W,F]=r.useState("yellow"),[O,T]=r.useState("#ef4444"),[H,_]=r.useState(3),[A,U]=r.useState(30),[Y,J]=r.useState(18),[X,q]=r.useState(!1),[G,Q]=r.useState("pen"),[V,K]=r.useState([]),[Z,ee]=r.useState("#FCD34D"),[te,re]=r.useState("freehand"),[se,ne]=r.useState(!1),[oe,le]=r.useState(""),[ae,ie]=r.useState([]),ce=X&&"highlighter"===G&&"text"===te,de=N&&"highlighter"===P||ce,he=ce?Z:"yellow"===W?"#FFD400":"#FF3B3B",ue=((e,t)=>{const{r:r,g:s,b:n}=z(e);return`rgba(${r}, ${s}, ${n}, ${t?.2:.12})`})(he,Boolean(a)),xe=((e,t)=>{const{r:r,g:s,b:n}=z(e);return`rgba(${r}, ${s}, ${n}, ${t?.6:.45})`})(he,Boolean(a)),ge=de?{"--selection-bg":ue,"--selection-fg":"currentColor","--selection-glow":xe}:void 0,me=r.useMemo(()=>B.filter(e=>"rect-highlight"===e.tool).length,[B]),be=`dentedge_study_v1_${t}_${s||"main"}`,pe=e=>{I(t=>{const r=e(t);if(0===r.length)try{localStorage.removeItem(be)}catch{}return r})},fe=ce?()=>{pe(e=>{const t=[...e].reverse().findIndex(e=>"rect-highlight"===e.tool);if(-1===t)return e;const r=e.length-1-t;return e.filter((e,t)=>t!==r)})}:()=>K(e=>e.slice(0,-1)),ve=ce?()=>{pe(e=>e.filter(e=>"rect-highlight"!==e.tool))}:()=>K([]),ke=ce?me>0:V.length>0;r.useEffect(()=>{const e=localStorage.getItem(be);if(e)try{const{savedStrokes:t}=JSON.parse(e);t&&I(t)}catch(t){}},[be]),r.useEffect(()=>{B.length>0&&localStorage.setItem(be,JSON.stringify({savedStrokes:B}))},[B,be]),r.useEffect(()=>{const e=()=>{if(!de)return;const e=window.getSelection();if(!e||0===e.rangeCount)return;const t=e.getRangeAt(0);if(e.toString().trim().length>2){const e=document.getElementById("content-area");if(!e)return;const r=e.getBoundingClientRect(),s=t.getClientRects(),n=[];for(let t=0;t<s.length;t++){const e=s[t];n.push({x:e.left-r.left,y:e.top-r.top}),n.push({x:e.width,y:e.height})}if(n.length>0){const e={tool:"rect-highlight",points:n,color:he,width:0};I(t=>[...t,e]),setTimeout(()=>{var e;window.getSelection&&(null==(e=window.getSelection())||e.removeAllRanges())},100)}}};return document.addEventListener("mouseup",e),document.addEventListener("touchend",e),()=>{document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)}},[de,he]),r.useEffect(()=>{(async()=>{p(!0);try{const r=await b(t,n,s),o=`${t}|${s||""}`,l=localStorage.getItem(`dentedge_edit_${o}`);if(l)try{const e=JSON.parse(l);r.content=e.content,r.keyPoints=e.keyPoints}catch(e){}else if(o in E){const e=E[o];e&&"content"in e&&"keyPoints"in e&&(r.content=e.content,r.keyPoints=e.keyPoints)}u(r),v(!1),i&&(null==r?void 0:r.content)&&i(r.content)}catch(r){}finally{p(!1)}})()},[t,n,s]),r.useEffect(()=>{if(!(null==h?void 0:h.content))return;let e=!1;const t=()=>{e||v(!0)},r=window.requestIdleCallback,s=window.cancelIdleCallback;if(r&&s){const n=r(t,{timeout:120});return()=>{e=!0,s(n)}}const n=window.setTimeout(t,0);return()=>{e=!0,window.clearTimeout(n)}},[null==h?void 0:h.content]);const we=`${t}|${s||""}`;return x?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[600px]",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-purple-500"}),e.jsx("p",{className:"mt-4 font-bold text-slate-500",children:"Loading Notes..."})]}):h?e.jsxs("div",{className:"max-w-[1600px] mx-auto pb-24 px-4 sm:px-6 relative",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-10 py-4 justify-between border-b dark:border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:l,className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:s||t})]}),d&&!se&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{h&&(le(h.content),ie([...h.keyPoints]),ne(!0))},className:"p-2 text-slate-400 hover:text-purple-600 dark:hover:text-purple-400 transition-colors",title:"Edit content",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>{const e={...E};for(const o of Object.keys(localStorage))if(o.startsWith("dentedge_edit_"))try{e[o.replace("dentedge_edit_","")]=JSON.parse(localStorage.getItem(o))}catch(n){}const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download="contentOverrides.json",s.click(),URL.revokeObjectURL(r)},className:"p-2 text-slate-400 hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors",title:"Export all overrides for deploy",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 relative",children:[e.jsx("div",{className:"lg:col-span-9",children:se?e.jsxs("section",{className:"p-0 rounded-none bg-transparent border-none shadow-none relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx(D,{onInsert:(e,t)=>{const r=document.getElementById("admin-edit-textarea");if(!r)return;const s=r.selectionStart,n=r.selectionEnd;t?(le(r=>r.slice(0,s)+e+r.slice(s,n)+t+r.slice(n)),requestAnimationFrame(()=>{r.selectionStart=s+e.length,r.selectionEnd=s+e.length+(n-s),r.focus()})):(le(t=>t.slice(0,s)+e+t.slice(n)),requestAnimationFrame(()=>{r.selectionStart=s+e.length,r.selectionEnd=s+e.length,r.focus()}))},onSave:()=>{localStorage.setItem(`dentedge_edit_${we}`,JSON.stringify({content:oe,keyPoints:ae})),h&&u({...h,content:oe,keyPoints:ae}),ne(!1)},onCancel:()=>ne(!1)})}),e.jsx("textarea",{id:"admin-edit-textarea",value:oe,onChange:e=>le(e.target.value),className:"w-full h-[650px] p-6 text-slate-800 dark:text-slate-100 leading-8 text-base bg-white dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Edit content here..."}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Key Points"}),e.jsx("textarea",{value:ae.join("\n"),onChange:e=>ie(e.target.value.split("\n").filter(Boolean)),className:"w-full h-[140px] p-4 text-slate-800 dark:text-slate-100 leading-7 text-base bg-white dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"One key point per line..."})]})]}):e.jsx("section",{className:"glass-panel p-10 md:p-14 rounded-[2.5rem] bg-white dark:bg-black border border-slate-100 dark:border-white/5 shadow-sm dark:shadow-none relative",children:e.jsxs("div",{className:"relative",id:"content-area",children:[e.jsx(w,{tool:N?P:"highlighter",active:N||de,strokes:B,onStrokeComplete:e=>I(t=>[...t,e]),onEraseStroke:e=>I(t=>t.filter((t,r)=>r!==e)),onStrokesUpdate:e=>I(e),color:O,strokeWidth:H,eraserSize:A,highlightBlendMode:ce?"screen":void 0,isDarkMode:a}),f?e.jsx("div",{className:"prose-sm prose-slate dark:prose-invert max-w-none text-slate-800 dark:text-slate-200 leading-7 md:leading-8 "+(de?"allow-selection cursor-text":"select-none"),style:{fontSize:`${Y}px`,...ge||{}},onContextMenu:e=>e.preventDefault(),onCopy:e=>{de&&(e.preventDefault(),alert("Content copying is disabled to protect medical data."))},children:e.jsx(R,{content:h.content,setSelectedImage:C,isGIC:(null==s?void 0:s.toLowerCase().includes("gic"))||h.subject===m.DENTAL_MATERIALS&&(null==s?void 0:s.toLowerCase().includes("glass"))})}):e.jsxs("div",{className:"min-h-[420px] flex flex-col items-center justify-center gap-3 text-slate-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-slate-400"}),e.jsx("p",{className:"text-sm font-semibold",children:"Preparing notes…"})]}),e.jsx(S,{isActive:X,currentTool:G,highlightMode:te,strokes:V,setStrokes:K,currentColor:Z,isDarkMode:a})]})})}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"p-6 bg-amber-50 dark:bg-amber-900/10 rounded-3xl border border-amber-200 dark:border-amber-500/20",children:[e.jsx("h3",{className:"font-bold text-amber-600 mb-4 text-lg",children:"Quick Pearls"}),e.jsx("ul",{className:"space-y-3 text-base",children:h.keyPoints.map((t,r)=>e.jsxs("li",{children:["• ",t]},r))})]}),e.jsx("button",{onClick:o,className:"w-full p-6 bg-cyan-600 text-white font-bold rounded-3xl shadow-lg shadow-cyan-900/20 transition-transform active:scale-95 text-lg",children:"Start Quiz"})]})]}),"undefined"!=typeof document&&g.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>q(e=>!e),className:"fixed top-20 right-8 z-[260] p-3 rounded-2xl backdrop-blur-xl border shadow-2xl transition-all active:scale-95 "+(X?"bg-blue-600 text-white border-blue-500/40 shadow-blue-900/30":"bg-white/90 dark:bg-slate-800/90 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-white/10 hover:text-cyan-600 dark:hover:text-white"),title:X?"Exit Study Mode":"Study Mode","aria-pressed":X,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx(j,{fontSize:Y,setFontSize:J}),X&&e.jsx("div",{className:"fixed top-52 right-8 z-[255] pointer-events-auto",children:e.jsx($,{currentTool:G,setTool:Q,onUndo:fe,onClear:ve,canUndo:ke,currentColor:Z,onColorChange:ee,highlightMode:te,onHighlightModeChange:re})}),N&&e.jsxs("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-[90] flex items-center gap-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur-xl p-4 rounded-full border shadow-2xl animate-in slide-in-from-bottom-10",children:[e.jsx("button",{onClick:()=>{I([]),localStorage.removeItem(be)},className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg mr-2",title:"Clear all study marks",children:"Clear"}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("button",{onClick:()=>I(e=>e.slice(0,-1)),disabled:0===B.length,className:"p-2 font-bold "+(0===B.length?"text-slate-300 dark:text-slate-700":"text-slate-500 hover:text-slate-900 dark:hover:text-white"),children:"Undo"}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700"}),e.jsxs("button",{onClick:()=>L("pen"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("pen"===P?"bg-blue-500 text-white shadow-lg shadow-blue-500/30":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 shadow-sm "+("pen"===P?"ring-2 ring-white":"")}),e.jsx("span",{className:"font-bold text-sm",children:"Pen"})]}),e.jsxs("button",{onClick:()=>L("highlighter"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("highlighter"===P?"bg-slate-100 dark:bg-white/10 ring-2 ring-blue-500":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx("div",{onClick:e=>{e.stopPropagation(),F("yellow"),L("highlighter")},className:"w-4 h-4 rounded-full bg-yellow-400 border border-yellow-600/20 "+("yellow"===W?"ring-2 ring-blue-500 ring-offset-2":""),title:"Yellow Highlight"}),e.jsx("div",{onClick:e=>{e.stopPropagation(),F("red"),L("highlighter")},className:"w-4 h-4 rounded-full bg-red-500 border border-red-600/20 "+("red"===W?"ring-2 ring-blue-500 ring-offset-2":""),title:"Red Text Highlight"}),e.jsx("span",{className:"font-bold text-sm ml-1",children:"Highlighter"})]}),e.jsxs("button",{onClick:()=>L("eraser"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all "+("eraser"===P?"bg-slate-800 text-white shadow-lg":"text-slate-500 hover:bg-slate-100 dark:hover:bg-white/5"),children:[e.jsx(c,{size:16,strokeWidth:2,className:"transition-transform "+("eraser"===P?"scale-125":"scale-100")}),e.jsx("span",{className:"font-bold text-sm",children:"Eraser"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 font-black text-blue-500 hover:text-blue-600",children:"Close"})]})]}),document.body),y&&e.jsx(k,{src:y,onClose:()=>C(null)})]}):e.jsx("div",{children:"Error loading content"})};export{L as default};
