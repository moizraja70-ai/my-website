import{a as e,j as t,i as s}from"./vendor-react-DkY5wy_m.js";import{D as a,d as r,M as n,e as o,s as i,h as l}from"./index-C2tm82ch.js";import"./vendor-CimuxmzX.js";import"./vendor-markdown-CUtcwKjt.js";import"./vendor-react-dom-D9MoHZUj.js";import"./content-gic-thwEcWs7.js";import"./content-impression-DXBt_6OM.js";import"./content-gypsum-BiKxCYUT.js";import"./content-composite-TJ9nDpJr.js";import"./content-adhesion-Cn4bavKK.js";import"./content-wax-BDxVPrGY.js";import"./content-metals-D-Ap74sk.js";import"./content-investment-BmTIz0j7.js";import"./content-casting-qFCp4nAV.js";import"./content-cements-BGuPplC7.js";import"./content-amalgam-BEu4a1oj.js";import"./content-ceramics-BD3nGYw3.js";import"./content-properties-BHcOlrks.js";import"./content-denture-B8gJ77JC.js";import"./content-embryology-Czmh6K7E.js";const d=()=>{const[i,d]=e.useState([]),[c,x]=e.useState(""),[m,h]=e.useState(!1),[u,p]=e.useState(!1),[g,b]=e.useState(""),[f,w]=e.useState(0),[j,y]=e.useState(!1),[v,k]=e.useState(()=>"undefined"!=typeof window&&localStorage.getItem("selectedAIModel")||a),N=e.useRef(null);e.useEffect(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},[i,m]);const C=async(e,t)=>{null==e||e.preventDefault();const s=(t??c).trim();if(!s||m||u)return;const a=s;x("");const r={role:"user",text:a,timestamp:new Date},n=[...i,r];d(n),h(!0);try{let e=g,t=f;Math.max(0,n.length-3);const s=false,r=s?Math.max(t,n.length-3):Math.max(0,n.length-3),o=n.slice(r,n.length-1).map(e=>({role:e.role,text:e.text})),i=await l(a,"Public",void 0,{summary:e,recentMessages:o},v),c=(e=>{const t=[];return(e.toLowerCase().includes("mechanism")||e.toLowerCase().includes("pathway"))&&t.push("What are the clinical implications of this mechanism?"),(e.toLowerCase().includes("treatment")||e.toLowerCase().includes("therapy"))&&t.push("What are the contraindications or side effects?"),(e.toLowerCase().includes("disease")||e.toLowerCase().includes("condition"))&&t.push("How is this diagnosed in clinical practice?"),(e.toLowerCase().includes("drug")||e.toLowerCase().includes("medication"))&&t.push("How does this drug interact with other medications?"),0===t.length&&t.push("Can you explain that in more detail?"),e.match(/(?:regarding|about|concerning)\s+([^.!?]+)/i)?t.push("What's the differential diagnosis for this?"):t.push("How is this tested in exams?"),[...new Set(t)].slice(0,3)})(i),x={role:"ai",text:i,timestamp:new Date,suggestedQuestions:c};d(e=>[...e,x])}catch(o){if((e=>{const t=((null==e?void 0:e.message)||JSON.stringify(e)||"").toLowerCase();return t.includes("quota")||t.includes("resource_exhausted")||t.includes("rate limit")||t.includes("429")})(o))p(!0),d(e=>[...e,{role:"ai",text:"âš ï¸ **Daily limit reached** - You've hit the daily token limit for this model tier.\n\n**Premium Models** (GPT-5.2, GPT-4o, GPT-4 Turbo): 250K tokens/day (shared)\n\n**Standard Models** (GPT-4o Mini, GPT-3.5 Turbo): 2.5M tokens/day (shared)\n\nPlease try again after midnight UTC when the quota resets.",timestamp:new Date}]);else{const e=o.message||JSON.stringify(o);d(t=>[...t,{role:"ai",text:`I encountered an error: **"${e}"**.\n\n**Fix:** Do not use a browser-exposed \`VITE_OPENAI_API_KEY\` (it will be leaked/blocked). In Cloudflare **Pages**: open your project â†’ **Settings â†’ Environment variables** â†’ add the server-side secret \`OPENAI_API_KEY\` (Production, and Preview if needed), then redeploy. The app calls the \`/api/openai\` proxy.`,timestamp:new Date}])}}finally{h(!1)}};return t.jsxs("div",{className:"max-w-5xl mx-auto h-[calc(100vh-12rem)] flex flex-col glass-panel rounded-[2rem] overflow-hidden bg-white/60 dark:bg-slate-900/40",children:[t.jsxs("div",{className:"border-b border-slate-200 dark:border-white/5 px-8 py-5 flex items-center justify-between bg-slate-50/80 dark:bg-slate-900/50",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-cyan-600 to-blue-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-cyan-900/50",children:t.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-bold text-slate-900 dark:text-white text-lg",children:"DentEdge AI Tutor"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"flex h-2 w-2 relative",children:[t.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),t.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),t.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-bold uppercase tracking-wider",children:"Active Learning Session"})]})]})]}),t.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/5 hover:border-cyan-500/50 dark:hover:border-cyan-500/50 transition-colors group",title:"Select AI Model",children:[t.jsx("svg",{className:"w-4 h-4 text-slate-600 dark:text-slate-400 group-hover:text-cyan-600 dark:group-hover:text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),t.jsx("span",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 group-hover:text-cyan-600 dark:group-hover:text-cyan-400",children:r(v)})]})]}),t.jsxs("div",{ref:N,className:"flex-1 overflow-y-auto p-8 space-y-8 bg-slate-50/50 dark:bg-slate-950/30",children:[0===i.length?t.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center max-w-lg mx-auto space-y-8",children:[t.jsx("div",{className:"w-24 h-24 bg-slate-200 dark:bg-slate-800 rounded-full flex items-center justify-center text-cyan-600 dark:text-cyan-500 relative ring-1 ring-slate-300 dark:ring-white/10",children:t.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-3",children:"Welcome to your Personal Clinic."}),t.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg leading-relaxed",children:"I am trained in clinical medicine and medical education. How can I help clarify your studies today?"})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 w-full",children:["Explain Heart Failure types","Cushing vs Addison Disease","Differential for Hematuria","MOA of Statins"].map(e=>t.jsx("button",{onClick:()=>{x(e)},className:"text-left p-4 text-sm font-medium bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-white/5 rounded-2xl hover:border-cyan-500/50 hover:text-cyan-600 dark:hover:text-cyan-400 text-slate-600 dark:text-slate-300 transition-all shadow-sm hover:shadow-md",children:e},e))})]}):i.map((e,a)=>t.jsx("div",{children:t.jsx("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-3 duration-500`,children:t.jsxs("div",{className:"max-w-[85%] flex flex-col "+("user"===e.role?"items-end":"items-start"),children:[t.jsx("div",{className:"px-6 py-4 rounded-3xl leading-relaxed "+("user"===e.role?"bg-cyan-600 text-white rounded-tr-none shadow-[0_0_20px_rgba(8,145,178,0.3)] text-sm font-medium":"bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-200 shadow-sm border border-slate-200 dark:border-white/5 rounded-tl-none medical-serif text-base"),children:"ai"===e.role?t.jsx("div",{className:"prose prose-sm max-w-none prose-p:leading-relaxed prose-headings:text-slate-900 dark:prose-headings:text-white prose-strong:text-cyan-600 dark:prose-strong:text-cyan-400 prose-slate dark:prose-invert",children:t.jsx(s,{components:{a:n},children:e.text})}):t.jsx("div",{className:"whitespace-pre-wrap",children:e.text})}),t.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 mt-2 font-bold px-2 uppercase tracking-widest",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),"ai"===e.role&&e.suggestedQuestions&&e.suggestedQuestions.length>0&&t.jsx("div",{className:"mt-4 flex flex-col gap-2 w-full max-w-md",children:e.suggestedQuestions.map((e,s)=>t.jsxs("button",{onClick:()=>C(void 0,e),className:"text-left px-4 py-3 text-xs font-semibold bg-cyan-50 dark:bg-cyan-900/20 border border-cyan-200 dark:border-cyan-800 rounded-2xl text-cyan-700 dark:text-cyan-300 hover:bg-cyan-100 dark:hover:bg-cyan-900/40 transition-colors",children:["ðŸ’¡ ",e]},s))})]})})},a)),m&&t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"bg-white dark:bg-slate-800 px-6 py-5 rounded-3xl shadow-sm border border-slate-200 dark:border-white/5 rounded-tl-none flex items-center gap-4",children:[t.jsxs("div",{className:"flex gap-1.5",children:[t.jsx("div",{className:"w-2.5 h-2.5 bg-cyan-500 rounded-full animate-bounce"}),t.jsx("div",{className:"w-2.5 h-2.5 bg-cyan-500 rounded-full animate-bounce [animation-delay:0.2s]"}),t.jsx("div",{className:"w-2.5 h-2.5 bg-cyan-500 rounded-full animate-bounce [animation-delay:0.4s]"})]}),t.jsx("span",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-[0.2em]",children:"Consulting Textbook..."})]})})]}),t.jsxs("div",{className:"p-6 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-white/5",children:[u&&t.jsx("div",{className:"mb-3 text-xs font-semibold text-red-700 bg-red-100/80 dark:text-red-300 dark:bg-red-900/40 px-4 py-3 rounded-xl border border-red-300 dark:border-red-700",children:"âš ï¸ Daily limit reached for this model tier. Resets at midnight UTC."}),t.jsxs("form",{onSubmit:C,className:"relative flex items-center gap-3 max-w-4xl mx-auto",children:[t.jsx("input",{type:"text",value:c,onChange:e=>x(e.target.value),disabled:u,placeholder:"Ask a question about physiology, pathology, or clinical cases...",className:"flex-1 bg-slate-100 dark:bg-slate-950 border border-slate-200 dark:border-white/5 rounded-2xl px-8 py-5 text-slate-900 dark:text-white placeholder:text-slate-500 focus:ring-1 focus:ring-cyan-500/50 outline-none transition-all pr-20 text-base"}),t.jsx("button",{type:"submit",disabled:!c.trim()||m||u,className:"absolute right-2.5 p-3 rounded-xl transition-all "+(!c.trim()||m||u?"text-slate-400 dark:text-slate-600":"bg-cyan-600 text-white shadow-[0_0_15px_rgba(6,182,212,0.4)] hover:bg-cyan-500 active:scale-90"),children:t.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]})]}),t.jsx(o,{currentModel:v,onModelChange:e=>{k(e),"undefined"!=typeof window&&localStorage.setItem("selectedAIModel",e)},isOpen:j,onClose:()=>y(!1)})]})};export{d as default};
